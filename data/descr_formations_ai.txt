;
; Rome Total War: "Sinuhet's AI Battle Formations Mod"  by Sinuhet/Pavel Vesely
; version 7.0, only for RTW 1.5 (vanilla and mods based on the RTW with patch 1.5), September 24, 2006
;
; (This file was manually modified for a bit more challenging AI in battles - Sinuhet.)
;	
;	This file describes the unit group formation templates, any number of group formations can be specified
;	these templates are used to give a group of units a formation, the units available  in the group may not	
;	totally fit the template in which case a best-fit is determined when the formation is created
;	
;	Formation block positions can either be specified with a relative normalised (x,z) or they can be specified
;	relative to another formation block (when specifying in this manner rotation CANNOT be given)
;	a formation must be described entirely in one method or the other
;
;							
;	formation						the name given to this formation template
;
;	formation purposes				hints to ai for using this formation
;
;	ai_priority						hint to the ai, denotes priority of using this template
;
;	BLOCK SPEC
;
;	unit_type						specifies units that can be allocated to the block
;									either : -
;												any
;												phalanx
;												non_phalanx_spear
;												chanting_screeching
;												ranged_missile_infantry
;												elephants
;												heavy_chariots
;												pilum_infantry
;												<UNIT_CLASS> <UNIT_CATEGORY> <PRIORITY>
;									the priority dictates the order of assigning different unit types
;									a priority of zero means that type will only ever be assigned to this block
;									to fulfill block minimums
;	default_melee_state <OPTIONAL>	the melee state that will be assigned to units
;									in the formation
;	unit_formation					the formation the units within this block will be in (wedge, square, ...)
;	unit_density					either loose or close
;	block_formation					the formation to organise the block into	(square, column, line)
;	normalised_pos					(x,z) position relative to the center of the template (in normalised coords)
;	normalised_rot					rotation in degress relative to the orientation of the template															
;	block_relative_pos				b x z (x,z) position (in metres) relative to formation block b		
;	inter_unit_spacing				distance to space units (in metres) 
;	priority						dictates the order in which units are assigned to the block



;****************************************************************
;****************************************************************
; BI section
;****************************************************************
;****************************************************************

;**********************************************************************************************************************
; Nomad/ Hun bull-horn formation, with cavalry on the wings but ahead of the infantry line (for double-envelopment) ***
;**********************************************************************************************************************

begin_formation nomad_bullhorns

	;;; purpose flags
	attack
	defend

	ai_priority			3.0
	;; high priority to ensure it gets used for allowed factions (ie all nomad factions, including huns)
	supported_factions huns, slavs, sarmatians, roxolani, scythia

		;; centre block
		begin_block 0
			min_units			1
			unit_type			heavy infantry		1.0
			unit_type			light infantry		0.8
			unit_type			infantry			0.1
			unit_type			any					0.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0 
			inter_unit_spacing	3.0
			priority			1.0
		end_block

		;; right of centre
		begin_block 1
			unit_type			missile infantry	1.0
			unit_type			light infantry		1.0
			unit_type			skirmish infantry	1.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 3.0 0.0 
			inter_unit_spacing	3.0
			priority			0.9
		end_block

		;; right cavalry wing
		begin_block 2
			unit_type			cavalry				1.0
			unit_density		close
			block_formation		line
			block_relative_pos	1 3.0 20.0 
			inter_unit_spacing	3.0
			priority			0.9
		end_block

		;; right front horse archer wing
		begin_block 3
			unit_type			missile cavalry				1.0
			unit_density		close
			block_formation		line
			block_relative_pos	2 3.0 20.0 
			inter_unit_spacing	3.0
			priority			0.9
		end_block

		;; left of centre
		begin_block 4
			unit_type			missile infantry	1.0
			unit_type			light infantry		1.0
			unit_type			skirmish infantry	1.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 -3.0 0.0 
			inter_unit_spacing	3.0
			priority			0.9
		end_block

		;; left cavalry wing
		begin_block 5
			unit_type			cavalry				1.0
			unit_density		close
			block_formation		line
			block_relative_pos	4 -3.0 20.0 
			inter_unit_spacing	3.0
			priority			0.9
		end_block

		;; left front horse archer wing
		begin_block 6
			unit_type			missile cavalry				1.0
			unit_density		close
			block_formation		line
			block_relative_pos	5 -3.0 20.0 
			inter_unit_spacing	3.0
			priority			0.9
		end_block

		;; put the artillery and handlers behind everyone
		begin_dummy_block 7
			spans 0 1 2 3 4 5 6
		end_dummy_block

		begin_block 8
			unit_type					handler				1.0
			unit_type					siege				1.0
			unit_type					chanting_screeching 3.0
			block_formation				line
			block_relative_pos			7 0.0 -5.0
			inter_unit_spacing			3.0
			priority					1.0
		end_block	
			
		begin_block 9
			min_units				1
			max_units				1
			unit_type				general_unit			1.0
			unit_density			close
			block_formation			line
			block_relative_pos		8 0.0 -10.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block
						

end_formation




;****************************************************************
;Special formation for romans (with precursor weapons)		*
;2 lines of inf (HEAVY in front) cav on the wings		*
;****************************************************************

begin_formation ai_roman_precursor_line

	;;; purpose flags
	attack
	defend

	ai_priority			3.0
	;; high priority to ensure it gets used for allowed factions (ie romans)
	supported_factions romans_julii, romans_brutii, romans_scipii, romans_senate


		; Screen of missile inf
		begin_block 0
			unit_type			missile infantry 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; First line of infantry
		begin_block 1
		;;	unit_type			light infantry 0.9 ;;NOT INCLUDED
			unit_type			heavy infantry 1.0
		;;	unit_type			spearmen_pilum_infantry 0.4 ;;NOT INCLUDED
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -7.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; left flank spears
		begin_block 2
			unit_type			spearmen 1.0
			block_formation		line
			block_relative_pos	1 -5.0 0
			inter_unit_spacing	2.0
			priority			0.1
		end_block

		;; right_flank spears
		begin_block 3
			unit_type			spearmen 1.0
			block_formation		line
			block_relative_pos	1 5.0 0
			inter_unit_spacing	2.0
			priority			0.1
		end_block


		;; second line of infantry
		begin_block 4
			unit_type			heavy infantry 0.9
			unit_type			light infantry 1.0
			unit_type			spearmen_pilum_infantry 10.0
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block


		;; Archers behind
		begin_block 5
			unit_type			ranged_missile_infantry 1.0
			block_formation		line
			block_relative_pos	4 0.0 -10.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block


		;; artillery, general and handlers at the back
		begin_block 6
			unit_type			handler				1.0
			unit_type			siege				1.0
			unit_type			general_unit		2.0
			unit_type			chanting_screeching 3.0
			unit_type			any					0.01
			block_formation		line
			block_relative_pos	5 0.0 -8.0
			inter_unit_spacing	2.0
			priority			0.4
		end_block

		begin_dummy_block 7
			spans 1 2 3 4 5 6
		end_dummy_block

		;; cavalry on the flanks and topwards back

		;; left flank cav
		begin_block 8
			unit_type			cavalry 1.0
			block_formation		line
			block_relative_pos	7 -5.0 -1.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank cav
		begin_block 9
			unit_type			cavalry 1.0
			block_formation		line
			block_relative_pos	7 5.0 -1.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			unit_type			missile cavalry 1.0
			block_formation		line
			block_relative_pos	8 -5.0 1.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			unit_type			missile cavalry 1.0
			block_formation		line
			block_relative_pos	9 5.0 1.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block


end_formation





;****************************************************************
;****************************************************************
; Phalanx section
;****************************************************************
;****************************************************************

;*******************************************************************************
; Phalanx multiwave attack formation, max 7 phalanx units (created by Sinuhet)
;*******************************************************************************

begin_formation phalanx_with_infantry_1d

	;;; purpose flags - defending
	defend
	
	ai_priority			2.8

		; Screen of missile inf
		begin_block 0
			max_units			5			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; heavy and light infantry before the spearmen

		;; light and heavy infantry
		begin_block 1
			min_units			7
			unit_type			light infantry 1.0
                        unit_type			heavy infantry 0.9
			;default_melee_state	fire_at_will_and_defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -7.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		;; non_phalanx spearmen infantry
		begin_block 2
			min_units			1
			max_units			7
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		;; phalanx line, maximal 7 phalanges
		begin_block 3
			min_units			1
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	0.3
			priority			0.95
		end_block

		;; missile troops behind the spearmen
		begin_block 4
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.5
			unit_type			chanting_screeching 0.3
			unit_type			skirmish infantry	0.4
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		begin_dummy_block 5
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 6
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 8
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 10
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		3 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 11
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			3 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 12
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			11 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation phalanx_with_infantry_1a

	;;; purpose flags - approaching
	defend
	attack
	
	ai_priority			2.8

		; Screen of missile inf
		begin_block 0
			max_units			5			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; heavy and light infantry before the spearmen

		;; light and heavy infantry
		begin_block 1
			min_units			7
			unit_type			light infantry 1.0
                        unit_type			heavy infantry 0.9
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -7.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		;; non_phalanx spearmen infantry
		begin_block 2
			min_units			1
			max_units			7
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		;; phalanx line, maximal 7 phalanges
		begin_block 3
			min_units			1
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	0.3
			priority			0.95
		end_block

		;; missile troops behind the spearmen
		begin_block 4
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.5
			unit_type			chanting_screeching 0.3
			unit_type			skirmish infantry	0.4
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		begin_dummy_block 5
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 6
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 8
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 10
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		3 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 11
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			3 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 12
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			11 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation phalanx_with_infantry_1b

	;;; purpose flags
	attack
	
	ai_priority			2.8

		; Screen of missile inf
		begin_block 0
			max_units			5			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; heavy and light infantry before the spearmen

		;; light and heavy infantry
		begin_block 1
			min_units			7
			unit_type			light infantry 1.0
                        unit_type			heavy infantry 0.9
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -7.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		;; non_phalanx spearmen infantry
		begin_block 2
			min_units			1
			max_units			7
			unit_type			non_phalanx_spear 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		;; phalanx line, maximal 7 phalanges
		begin_block 3
			min_units			1
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	0.3
			priority			0.95
		end_block

		;; missile troops behind the spearmen
		begin_block 4
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.5
			unit_type			chanting_screeching 0.3
			unit_type			skirmish infantry	0.4
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		begin_dummy_block 5
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 6
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 8
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 10
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		5 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 11
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			5 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 12
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			11 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


;*********************************************************************************************
; Phalanx multiwave attack formation - 2nd version, max 7 phalanx units (created by Sinuhet)
;*********************************************************************************************

begin_formation phalanx_with_infantry_2d

	;;; purpose flags - defend
	defend
	
	ai_priority			2.8

		; Screen of missile inf
		begin_block 0
			max_units			5			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; heavy and light infantry before the spearmen

		;; light infantry
		begin_block 1
			min_units			3
			max_units			9
			unit_type			light infantry 1.0
                        unit_type			heavy infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -7.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		;; heavy infantry
		begin_block 2
			min_units			4
			max_units			10
			unit_type			heavy infantry 1.0
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		;; phalanx line, maximal 7 phalanges
		begin_block 3
			min_units			1
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	0.3
			priority			0.95
		end_block

		;; missile troops behind the spearmen
		begin_block 4
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.5
			unit_type			chanting_screeching 0.3
			unit_type			skirmish infantry	0.4
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		begin_dummy_block 5
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 6
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 8
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 10
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		3 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 11
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			3 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 12
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			11 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation phalanx_with_infantry_2a

	;;; purpose flags - approaching
	defend
	attack
	
	ai_priority			2.8

		; Screen of missile inf
		begin_block 0
			max_units			5			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; heavy and light infantry before the spearmen

		;; light infantry
		begin_block 1
			min_units			3
			max_units			9
			unit_type			light infantry 1.0
                        unit_type			heavy infantry 0.8
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -7.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		;; heavy infantry
		begin_block 2
			min_units			4
			max_units			10
			unit_type			heavy infantry 1.0
			unit_type			light infantry 0.8
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		;; phalanx line, maximal 7 phalanges
		begin_block 3
			min_units			1
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	0.3
			priority			0.95
		end_block

		;; missile troops behind the spearmen
		begin_block 4
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.5
			unit_type			chanting_screeching 0.3
			unit_type			skirmish infantry	0.4
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		begin_dummy_block 5
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 6
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 8
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 10
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		3 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 11
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			3 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 12
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			11 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation phalanx_with_infantry_2b

	;;; purpose flags
	attack
	
	ai_priority			2.8

		; Screen of missile inf
		begin_block 0
			max_units			5			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; heavy and light infantry before the spearmen

		;; light infantry
		begin_block 1
			min_units			3
			max_units			9
			unit_type			light infantry 1.0
                        unit_type			heavy infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -7.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		;; heavy infantry
		begin_block 2
			min_units			4
			max_units			10
			unit_type			heavy infantry 1.0
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		;; phalanx line, maximal 7 phalanges
		begin_block 3
			min_units			1
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	0.3
			priority			0.95
		end_block

		;; missile troops behind the spearmen
		begin_block 4
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.5
			unit_type			chanting_screeching 0.3
			unit_type			skirmish infantry	0.4
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		begin_dummy_block 5
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 6
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 8
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 10
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		5 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 11
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			5 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 12
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			11 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


;****************************************************************************************************
; Simplified Phalanx attack formation "Philip of Macedon", max 7 phalanx units (created by Sinuhet)
;****************************************************************************************************

begin_formation phalanx_attack_1d

	;;; purpose flags - defending
	defend

	ai_priority			2.8

        supported_factions		egypt, seleucid, macedon

		;; Skirmishing and front attack
		begin_block 0
			max_units			3			
			not_general
			unit_type			elephants		1.0
			unit_type			heavy_chariots		1.0
			unit_type			missile cavalry		0.9
			unit_type			skirmish infantry	0.6
			unit_type			chanting_screeching 0.5
			default_melee_state	fire_at_will_and_defend_and_skirmish
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block
		
		;; phalanx units
		begin_block 1
			min_units			3
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -20.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; infantry troops behind the spearmen
		begin_block 2
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.9
			;default_melee_state	defend
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; cavalry left to the phalanges
		begin_block 3
			min_units			3
			max_units			7
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 0.75
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 -40.0 -50.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; missile troops on both sides

		;; left side
		begin_block 4
			max_units			3
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.6
			unit_type			chanting_screeching 0.5
			default_melee_state	fire_at_will_and_defend_and_skirmish
                        min_unit_width			30
                        max_unit_width			35
			block_formation		line
			block_relative_pos	1 -3.0 0.0
			inter_unit_spacing	2.0
			priority			0.7
		end_block

		;; right side
		begin_block 5
			max_units			1			
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.6
			default_melee_state	fire_at_will_and_defend_and_skirmish
                        min_unit_width			30
                        max_unit_width			35
			block_formation		line
			block_relative_pos	1 3.0 0.0
			inter_unit_spacing	2.0
			priority			0.7
		end_block

		;; missile troops back
		begin_block 6
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.5
			default_melee_state	fire_at_will_and_defend
                        min_unit_width			30
                        max_unit_width			35
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 7
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		6 0.0 -5.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 8
			max_units			0
			unit_type			any					0.01
			block_formation				line
			block_relative_pos			7 0.0 -20.0
			inter_unit_spacing			0.3
			priority					0.01
		end_block

		;; artillery and handler behind
		begin_block 9
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			8 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		;; infantry troops prepared in the right wing
		begin_block 10
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.9
			block_formation		column
			block_relative_pos	5 10.0 0.0
			inter_unit_spacing	2.0
			priority			0.9
		end_block

		;; missile cavalry in the right wing
		begin_block 11
			max_units			2			
			not_general
			unit_type			missile cavalry 1.0
			unit_type			light cavalry 0.5
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	10 10.0 -20.0
			inter_unit_spacing	4.0
			priority			0.4
		end_block

end_formation


begin_formation phalanx_attack_1a

	;;; purpose flags - approaching
	defend
	attack

	ai_priority			2.8

        supported_factions		egypt, seleucid, macedon

		;; Skirmishing and front attack
		begin_block 0
			max_units			3			
			not_general
			unit_type			elephants		1.0
			unit_type			heavy_chariots		1.0
			unit_type			missile cavalry		0.9
			unit_type			skirmish infantry	0.6
			unit_type			chanting_screeching 0.5
			default_melee_state	fire_at_will_and_skirmish
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block
		
		;; phalanx units
		begin_block 1
			min_units			3
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -20.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; infantry troops behind the spearmen
		begin_block 2
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.9
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; cavalry left to the phalanges
		begin_block 3
			min_units			3
			max_units			7
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 0.75
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 -40.0 -50.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; missile troops on both sides

		;; left side
		begin_block 4
			max_units			3
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.6
			unit_type			chanting_screeching 0.5
			default_melee_state	fire_at_will_and_skirmish
                        min_unit_width			30
                        max_unit_width			35
			block_formation		line
			block_relative_pos	1 -3.0 0.0
			inter_unit_spacing	2.0
			priority			0.7
		end_block

		;; right side
		begin_block 5
			max_units			1			
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.6
			default_melee_state	fire_at_will_and_skirmish
                        min_unit_width			30
                        max_unit_width			35
			block_formation		line
			block_relative_pos	1 3.0 0.0
			inter_unit_spacing	2.0
			priority			0.7
		end_block

		;; missile troops back
		begin_block 6
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.5
			default_melee_state	fire_at_will_and_defend
                        min_unit_width			30
                        max_unit_width			35
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 7
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		6 0.0 -5.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 8
			max_units			0
			unit_type			any					0.01
			block_formation				line
			block_relative_pos			7 0.0 -20.0
			inter_unit_spacing			0.3
			priority					0.01
		end_block

		;; artillery and handler behind
		begin_block 9
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			8 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		;; infantry troops prepared in the right wing
		begin_block 10
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.9
			block_formation		column
			block_relative_pos	5 10.0 0.0
			inter_unit_spacing	2.0
			priority			0.9
		end_block

		;; missile cavalry in the right wing
		begin_block 11
			max_units			2			
			not_general
			unit_type			missile cavalry 1.0
			unit_type			light cavalry 0.5
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	10 10.0 -20.0
			inter_unit_spacing	4.0
			priority			0.4
		end_block

end_formation


begin_formation phalanx_attack_1b

	;;; purpose flags - attacking
	attack

	ai_priority			2.8

        supported_factions		egypt, seleucid, macedon

		;; Skirmishing and front attack
		begin_block 0
			max_units			3			
			not_general
			unit_type			elephants		1.0
			unit_type			heavy_chariots		1.0
			unit_type			missile cavalry		0.9
			unit_type			skirmish infantry	0.6
			unit_type			chanting_screeching 0.5
			default_melee_state	fire_at_will_and_skirmish
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block
		
		;; phalanx units
		begin_block 1
			min_units			3
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -20.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; infantry troops behind the spearmen
		begin_block 2
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.9
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; missile troops back
		begin_block 3
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.5
			default_melee_state	fire_at_will_and_skirmish
                        min_unit_width			30
                        max_unit_width			35
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; missile troops on both sides

		;; left side
		begin_block 4
			max_units			2
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.6
			unit_type			chanting_screeching 0.5
			default_melee_state	fire_at_will_and_skirmish
                        min_unit_width			30
                        max_unit_width			35
			block_formation		line
			block_relative_pos	1 -3.0 0.0
			inter_unit_spacing	2.0
			priority			0.7
		end_block

		;; missile troops right side
		begin_block 5
			max_units			1			
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.6
			default_melee_state	fire_at_will_and_skirmish
                        min_unit_width			30
                        max_unit_width			35
			block_formation		line
			block_relative_pos	1 3.0 0.0
			inter_unit_spacing	2.0
			priority			0.7
		end_block

		;; any behind
		begin_block 6
			max_units			0
			unit_type			any					0.01
			block_formation				line
			block_relative_pos			3 0.0 -30.0
			inter_unit_spacing			0.3
			priority					0.01
		end_block

		;; general at the back
		begin_block 7
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		1 0.0 -50.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; artillery and handler behind
		begin_block 8
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			1 0.0 -75.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		begin_dummy_block 9
			spans 1 5
		end_dummy_block

		;; cavalry in the left wing
		begin_block 10
			min_units			3
			max_units			7
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 0.75
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 -40.0 -60.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; infantry troops in the right wing
		begin_block 11
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.9
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	9 10.0 20.0
			inter_unit_spacing	2.0
			priority			0.9
		end_block

		;; missile cavalry in the right wing
		begin_block 12
			max_units			2			
			not_general
			unit_type			missile cavalry 1.0
			unit_type			light cavalry 0.5
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 10.0 -20.0
			inter_unit_spacing	4.0
			priority			0.4
		end_block

end_formation

;********************************************************************************
; Phalanx double line formation, min 8 phalanx units (created by Sinuhet)
;********************************************************************************

begin_formation phalanx_attack_2d

	;;; purpose flags - defending
	defend
	
	ai_priority			2.6

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first phalanx line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 2
			min_units			4
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 3
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 4
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 6
			spans 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 11
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		2 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			2 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			12 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation phalanx_attack_2a

	;;; purpose flags - approaching
	defend
	attack
	
	ai_priority			2.6

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first phalanx line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 2
			min_units			4
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 3
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 4
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 6
			spans 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 11
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		2 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			2 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			12 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation phalanx_attack_2b

	;;; purpose flags - attacking
	attack

	ai_priority			2.6

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first phalanx line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 2
			min_units			4
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 3
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 4
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 6
			spans 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 11
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		6 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			6 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			12 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation

;*******************************************************************************
; Phalanx triple line formation, min 13 phalanx units (created by Sinuhet)
;*******************************************************************************

begin_formation phalanx_attack_3d

	;;; purpose flags - defending
	defend
	
	ai_priority			2.7

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first phalanx line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 2
			min_units			4
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third phalanx line
		begin_block 3
			min_units			5
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 6
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		3 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			3 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation phalanx_attack_3a

	;;; purpose flags - approaching
	defend
	attack
	
	ai_priority			2.7

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first phalanx line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 2
			min_units			4
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third phalanx line
		begin_block 3
			min_units			5
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 6
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		3 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			3 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation phalanx_attack_3b

	;;; purpose flags - attacking
	attack
	
	ai_priority			2.7

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first phalanx line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 2
			min_units			4
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third phalanx line
		begin_block 3
			min_units			5
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 6
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			7 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation

;********************************************************************************
; Phalanx single line attack formation, max 7 phalanx units (created by Sinuhet)
;********************************************************************************

begin_formation phalanx_attack_4d

	;;; purpose flags - defending
	defend
	
	ai_priority			2.5

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; phalanx line
		begin_block 1
			min_units			1
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 2
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 3
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 4
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 5
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 6
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 7
			max_units				2
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 8
			max_units				2
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 9
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		1 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 10
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			1 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 11
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			10 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation phalanx_attack_4a

	;;; purpose flags - approaching
	defend
	attack
	
	ai_priority			2.5

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; phalanx line
		begin_block 1
			min_units			1
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 2
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 3
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 4
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 5
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 6
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 7
			max_units				2
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 8
			max_units				2
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 9
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		1 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 10
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			1 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 11
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			10 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation phalanx_attack_4b

	;;; purpose flags - attacking
	attack

	ai_priority			2.5

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; phalanx line
		begin_block 1
			min_units			1
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 2
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 3
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 4
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 0.7
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 5
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 6
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 7
			max_units				2
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 8
			max_units				2
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 9
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		1 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 10
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			1 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 11
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			10 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


;********************************************************************************
; Mixed spearmen double line formation, max 12 spearmen units (created by Sinuhet)
;********************************************************************************

begin_formation mixed_spearmen_attack_1d

	;;; purpose flags - defending
	defend
	
	ai_priority			2.59

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first phalanx line
		begin_block 1
			min_units			2
			max_units			6
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 2
			min_units			2
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 3
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 4
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 6
			spans 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 11
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		2 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			2 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			12 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation mixed_spearmen_attack_1a

	;;; purpose flags - approaching
	defend
	attack
	
	ai_priority			2.59

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first phalanx line
		begin_block 1
			min_units			2
			max_units			6
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 2
			min_units			2
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 3
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 4
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 6
			spans 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 11
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		2 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			2 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			12 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation mixed_spearmen_attack_1b

	;;; purpose flags - attacking
	attack

	ai_priority			2.59

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first phalanx line
		begin_block 1
			min_units			2
			max_units			6
			unit_type			non_phalanx_spear 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 2
			min_units			2
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 3
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 4
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 6
			spans 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 11
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		6 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			6 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			12 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation

;*******************************************************************************
; mixed_spearmen triple line formation, min 7 phalanx units (created by Sinuhet)
;*******************************************************************************

begin_formation mixed_spearmen_attack_2d

	;;; purpose flags - defending
	defend
	
	ai_priority			2.69

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first phalanx line
		begin_block 1
			min_units			2
			max_units			6
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 2
			min_units			3
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third phalanx line
		begin_block 3
			min_units			4
			;max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 6
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		3 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			3 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation mixed_spearmen_attack_2a

	;;; purpose flags - approaching
	defend
	attack
	
	ai_priority			2.69

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first phalanx line
		begin_block 1
			min_units			2
			max_units			6
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 2
			min_units			3
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third phalanx line
		begin_block 3
			min_units			4
			;max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 6
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		3 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			3 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation mixed_spearmen_attack_2b

	;;; purpose flags - attacking
	attack
	
	ai_priority			2.69

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first phalanx line
		begin_block 1
			min_units			2
			max_units			6
			unit_type			non_phalanx_spear 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 2
			min_units			3
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third phalanx line
		begin_block 3
			min_units			4
			;max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 6
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			7 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


;*********************************************************************************************************
; mixed_spearmen triple line formation, max 6 phalanx units, min 7 spearmen units (created by Sinuhet)
;*********************************************************************************************************

begin_formation mixed_spearmen_attack_3d

	;;; purpose flags - defending
	defend
	
	ai_priority			2.68

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first phalanx line
		begin_block 1
			min_units			3
			max_units			7
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 2
			min_units			4
			;max_units			7
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third phalanx line
		begin_block 3
			min_units			2
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 6
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		3 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			3 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation mixed_spearmen_attack_3a

	;;; purpose flags - approaching
	defend
	attack
	
	ai_priority			2.68

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first phalanx line
		begin_block 1
			min_units			3
			max_units			7
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 2
			min_units			4
			;max_units			7
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third phalanx line
		begin_block 3
			min_units			2
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 6
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		3 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			3 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation mixed_spearmen_attack_3b

	;;; purpose flags - attacking
	attack
	
	ai_priority			2.68

	supported_factions		carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first phalanx line
		begin_block 1
			min_units			3
			max_units			7
			unit_type			non_phalanx_spear 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 2
			min_units			4
			;max_units			7
			unit_type			non_phalanx_spear 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third phalanx line
		begin_block 3
			min_units			2
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 6
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			7 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


;************************************************************************************************
; Universal Phalanx single line formation, max 7 spearmen units (created by Sinuhet)
;************************************************************************************************


begin_formation phalanx_defend_1

	;;; purpose flags
	attack
	defend
	
	ai_priority			2.2

	supported_factions		britons, gauls, germans, dacia, scythia, alemanni, spain, numidia, slave

		;; phalanx line
		begin_block 0
			min_units			1
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	0.3
			priority			0.95
		end_block

		;; missile troops behind the spearmen

		begin_block 1
			max_units			2
			unit_type			ranged_missile_infantry 0.9			
			unit_type			missile infantry	1.0
			unit_type			skirmish infantry	0.8
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_block 2
			max_units			2
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	1.0
			unit_type			chanting_screeching 0.5
			unit_type			skirmish infantry	0.8
                        max_unit_width		40
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.7
		end_block

		begin_block 3
			max_units			4
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.9
			unit_type			chanting_screeching 0.5
			unit_type			skirmish infantry	0.8
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		begin_block 4
			max_units			8
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.9
			unit_type			chanting_screeching 0.5
			unit_type			skirmish infantry	0.8
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block
		
		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 1.0
			unit_type			light infantry 0.8
			block_formation		column
			block_relative_pos	0 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 6
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 1.0
			unit_type			light infantry 0.8
			block_formation		column
			block_relative_pos	0 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 0 1 2 3 4 5 6
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 -20.0 -70.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 20.0 -70.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			max_units				2
			not_general
			unit_type			missile cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			max_units				2
			not_general
			unit_type			missile cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		0 0.0 -70.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			0 0.0 -90.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


;************************************************************************************************
; Universal Phalanx double line formation, min 8, max 12 spearmen units (created by Sinuhet)
;************************************************************************************************


begin_formation phalanx_defend_2

	;;; purpose flags
	attack
	defend
	
	ai_priority			2.3

	supported_factions		britons, gauls, germans, dacia, scythia, alemanni, spain, numidia, slave

		;; first phalanx line
		begin_block 0
			min_units			4
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; missile troops behind the spearmen

		begin_block 2
			max_units			2
			unit_type			ranged_missile_infantry 0.9			
			unit_type			missile infantry	1.0
			unit_type			skirmish infantry	0.8
                        max_unit_width		40
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_block 3
			max_units			2
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	1.0
			unit_type			chanting_screeching 0.5
			unit_type			skirmish infantry	0.8
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.7
		end_block

		begin_block 4
			max_units			4
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.9
			unit_type			chanting_screeching 0.5
			unit_type			skirmish infantry	0.8
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		begin_block 5
			max_units			8
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.9
			unit_type			chanting_screeching 0.5
			unit_type			skirmish infantry	0.8
                        max_unit_width		40
			block_formation		line
			block_relative_pos	4 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block
		
		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 6
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 1.0
			unit_type			light infantry 0.8
			block_formation		column
			block_relative_pos	0 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 7
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 1.0
			unit_type			light infantry 0.8
			block_formation		column
			block_relative_pos	0 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 -20.0 -70.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 20.0 -70.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		1 0.0 -70.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			1 0.0 -90.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


;************************************************************************************************
; Universal Phalanx triple line formation, min 13 spearmen units (created by Sinuhet)
;************************************************************************************************


begin_formation phalanx_defend_3

	;;; purpose flags
	attack
	defend
	
	ai_priority			2.4

	supported_factions		britons, gauls, germans, dacia, scythia, alemanni, spain, numidia, slave

		;; first phalanx line
		begin_block 0
			min_units			4
			max_units			6
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second phalanx line
		begin_block 1
			min_units			4
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third phalanx line
		begin_block 2
			min_units			5
			max_units			7
			unit_type			phalanx 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; missile troops behind the spearmen

		begin_block 3
			max_units			2
			unit_type			ranged_missile_infantry 0.9			
			unit_type			missile infantry	1.0
			unit_type			skirmish infantry	0.8
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_block 4
			max_units			2
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	1.0
			unit_type			chanting_screeching 0.5
			unit_type			skirmish infantry	0.8
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.7
		end_block

		begin_block 5
			max_units			4
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.9
			unit_type			chanting_screeching 0.5
			unit_type			skirmish infantry	0.8
                        max_unit_width		40
			block_formation		line
			block_relative_pos	4 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		begin_block 6
			max_units			8
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.9
			unit_type			chanting_screeching 0.5
			unit_type			skirmish infantry	0.8
                        max_unit_width		40
			block_formation		line
			block_relative_pos	5 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block
		
		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 7
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 1.0
			unit_type			light infantry 0.8
			block_formation		column
			block_relative_pos	0 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 8
			unit_type			heavy infantry 0.9
			unit_type			non_phalanx_spear 1.0
			unit_type			light infantry 0.8
			block_formation		column
			block_relative_pos	0 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 -20.0 -70.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 10
			not_general
			unit_type			cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 20.0 -70.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 12
			not_general
			unit_type			missile cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	10 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 13
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		2 0.0 -70.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 14
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			2 0.0 -90.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 15
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			14 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


;****************************************************************
;****************************************************************
; Non_phalanx spearmen of civilised countries section
;****************************************************************
;****************************************************************

;**********************************************************************************************
; Non-phalanx spearmen triple line formation, min 13 spearmen units (created by Sinuhet)
;**********************************************************************************************

begin_formation nonphalanx_attack_1d

	;;; purpose flags - defending
	defend
	
	ai_priority			2.4

	supported_factions		carthage, numidia, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			4
			max_units			7
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third spearmen line
		begin_block 3
			min_units			5
			max_units			7
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 6
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		3 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			3 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation nonphalanx_attack_1a

	;;; purpose flags - approaching
	defend
	attack
	
	ai_priority			2.4

	supported_factions		carthage, numidia, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			4
			max_units			7
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third spearmen line
		begin_block 3
			min_units			5
			max_units			7
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 6
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		3 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			3 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation nonphalanx_attack_1b

	;;; purpose flags - attacking
	attack
	
	ai_priority			2.4

	supported_factions		carthage, numidia, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			4
			max_units			7
			unit_type			non_phalanx_spear 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third spearmen line
		begin_block 3
			min_units			5
			max_units			7
			unit_type			non_phalanx_spear 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 6
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			7 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


;**************************************************************************************************
; Non-phalanx spearmen double line attack formation, min 8 spearmen units (created by Sinuhet)
;**************************************************************************************************

begin_formation nonphalanx_attack_2d

	;;; purpose flags - defending
	defend
	
	ai_priority			2.3

	supported_factions		carthage, numidia, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 3
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 4
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 5
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 6
			spans 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 11
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		2 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			2 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			12 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation nonphalanx_attack_2a

	;;; purpose flags - approaching
	defend
	attack
	
	ai_priority			2.3

	supported_factions		carthage, numidia, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 3
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 4
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 5
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 6
			spans 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 11
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		2 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			2 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			12 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation nonphalanx_attack_2b

	;;; purpose flags - attacking
	attack

	ai_priority			2.3

	supported_factions		carthage, numidia, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 3
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 4
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 5
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 6
			spans 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 11
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		6 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			6 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			12 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


;*********************************************************************************************
; Non-phalanx spearmen single line attack formation, max 7 spearmen units (created by Sinuhet)
;*********************************************************************************************

begin_formation nonphalanx_attack_3d

	;;; purpose flags - defending
	defend
	
	ai_priority			2.2

	supported_factions		carthage, numidia, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			1
			max_units			7
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 2
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 3
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 4
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 5
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 6
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 7
			max_units				2
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 8
			max_units				2
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 9
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		1 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 10
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			1 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 11
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			10 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation nonphalanx_attack_3a

	;;; purpose flags - approaching
	defend
	attack
	
	ai_priority			2.2

	supported_factions		carthage, numidia, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			1
			max_units			7
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 2
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 3
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 4
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 5
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 6
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 7
			max_units				2
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 8
			max_units				2
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 9
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		1 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 10
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			1 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 11
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			10 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation nonphalanx_attack_3b

	;;; purpose flags - attacking
	attack

	ai_priority			2.2

	supported_factions		carthage, numidia, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			1
			max_units			7
			unit_type			non_phalanx_spear 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 2
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 3
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 4
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 5
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 6
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 7
			max_units				2
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 8
			max_units				2
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 9
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		1 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 10
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			1 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 11
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			10 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


;****************************************************************
;****************************************************************
; Barbarian section
;****************************************************************
;****************************************************************

;************************************************************************************************
; Non_phalanx_spear single line attack formation, max 3 spearmen units (created by Sinuhet)
;************************************************************************************************

begin_formation barbar_attack_1d

	;;; purpose flags - defending
	defend
	
	ai_priority			2.20

	supported_factions		britons, gauls, germans, dacia, scythia, alemanni, spain, slave

		; Screen of missile inf
		begin_block 0
			max_units			3			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; spearmen line
		begin_block 1
			min_units			1
			max_units			3
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -20.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; missile troops behind the spearmen
		begin_block 2
			max_units			4
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 3
			max_units			3
			unit_type			heavy infantry 1.0
			unit_type			light infantry 0.8
			block_formation		line
			block_relative_pos	1 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		;; right side
		begin_block 4
			max_units			3
			unit_type			heavy infantry 1.0
			unit_type			light infantry 0.8
			block_formation		line
			block_relative_pos	1 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		begin_dummy_block 5
			spans 1 3 4
		end_dummy_block


		;; Screen of missile inf on both flanks

		;; left flank
		begin_block 6
			max_units			3			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		column
			block_relative_pos	5 -5.0 5.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; right flank
		begin_block 7
			max_units			3			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		column
			block_relative_pos	5 5.0 5.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit	1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		5 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler			1.0
			unit_type			siege			1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			5 0.0 -50.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		;; back line of other units
		begin_block 14
			max_units				0
			unit_type			any			0.01
			block_formation				line
			block_relative_pos			13 0.0 -10.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

end_formation


begin_formation barbar_attack_1a

	;;; purpose flags - approaching
	defend
	attack
	
	ai_priority			2.20

	supported_factions		britons, gauls, germans, dacia, scythia, alemanni, spain, slave

		; Screen of missile inf
		begin_block 0
			max_units			3			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; spearmen line
		begin_block 1
			min_units			1
			max_units			3
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -20.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; missile troops behind the spearmen
		begin_block 2
			max_units			4
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 3
			max_units			3
			unit_type			heavy infantry 1.0
			unit_type			light infantry 0.8
			block_formation		line
			block_relative_pos	1 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		;; right side
		begin_block 4
			max_units			3
			unit_type			heavy infantry 1.0
			unit_type			light infantry 0.8
			block_formation		line
			block_relative_pos	1 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		begin_dummy_block 5
			spans 1 3 4
		end_dummy_block


		;; Screen of missile inf on both flanks

		;; left flank
		begin_block 6
			max_units			3			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		column
			block_relative_pos	5 -5.0 5.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; right flank
		begin_block 7
			max_units			3			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		column
			block_relative_pos	5 5.0 5.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit	1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		5 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler			1.0
			unit_type			siege			1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			5 0.0 -50.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		;; back line of other units
		begin_block 14
			max_units				0
			unit_type			any			0.01
			block_formation				line
			block_relative_pos			13 0.0 -10.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

end_formation


begin_formation barbar_attack_1b

	;;; purpose flags
	attack
	
	ai_priority			2.20

	supported_factions		britons, gauls, germans, dacia, scythia, alemanni, spain, slave

		; Screen of missile inf
		begin_block 0
			max_units			3			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; spearmen line
		begin_block 1
			min_units			1
			max_units			3
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -20.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; missile troops behind the spearmen
		begin_block 2
			max_units			4
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 3
			max_units			3
			unit_type			heavy infantry 1.0
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	1 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		;; right side
		begin_block 4
			max_units			3
			unit_type			heavy infantry 1.0
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	1 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		begin_dummy_block 5
			spans 1 3 4
		end_dummy_block


		;; Screen of missile inf on both flanks

		;; left flank
		begin_block 6
			max_units			3			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		column
			block_relative_pos	5 -10.0 35.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; right flank
		begin_block 7
			max_units			3			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		column
			block_relative_pos	5 10.0 35.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit	1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		5 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler			1.0
			unit_type			siege			1.0
			block_formation				line
			block_relative_pos			5 0.0 -50.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		;; back line of other units
		begin_block 14
			max_units				0
			unit_type			any			0.01
			block_formation				line
			block_relative_pos			13 0.0 -10.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

end_formation

;********************************************************************************************************
; Non_phalanx_spear double line attack formation, min 4 and max 12 spearmen units (created by Sinuhet)
;********************************************************************************************************

begin_formation barbar_attack_2d

	;;; purpose flags - defending
	defend

	ai_priority			2.30

	supported_factions		britons, gauls, germans, dacia, scythia, alemanni, spain, slave

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			2
			max_units			6
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			2
			max_units			6
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 3
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block
		
		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 4
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			block_formation		line
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		;; right side
		begin_block 5
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			block_formation		line
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		begin_dummy_block 6
			spans 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 11
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		2 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			2 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			12 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation barbar_attack_2a

	;;; purpose flags - approaching
	defend
	attack

	ai_priority			2.30

	supported_factions		britons, gauls, germans, dacia, scythia, alemanni, spain, slave

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			2
			max_units			6
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			2
			max_units			6
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 3
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block
		
		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 4
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			block_formation		line
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		;; right side
		begin_block 5
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			block_formation		line
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		begin_dummy_block 6
			spans 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 11
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		2 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			2 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			12 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation barbar_attack_2b

	;;; purpose flags - attacking
	attack
	
	ai_priority			2.30

	supported_factions		britons, gauls, germans, dacia, scythia, alemanni, spain, slave

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			2
			max_units			6
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			2
			max_units			6
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 3
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block
		
		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 4
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		;; right side
		begin_block 5
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		begin_dummy_block 6
			spans 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 11
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		6 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			6 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			12 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation

;*******************************************************************************************
; Non_phalanx_spear triple line attack formation, min 13 spearmen units (created by Sinuhet)
;*******************************************************************************************

begin_formation barbar_attack_3d

	;;; purpose flags - defending
	defend
	
	ai_priority			2.40

	supported_factions		britons, gauls, germans, dacia, scythia, alemanni, spain, slave

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			4
			max_units			7
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third spearmen line
		begin_block 3
			min_units			5
			max_units			7
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block
		
		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			block_formation		line
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		;; right side
		begin_block 6
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			block_formation		line
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		3 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			3 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation barbar_attack_3a

	;;; purpose flags - defending and approaching
	defend
	attack
	
	ai_priority			2.40

	supported_factions		britons, gauls, germans, dacia, scythia, alemanni, spain, slave

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			4
			max_units			7
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third spearmen line
		begin_block 3
			min_units			5
			max_units			7
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block
		
		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			block_formation		line
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		;; right side
		begin_block 6
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			block_formation		line
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		3 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			3 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation barbar_attack_3b

	;;; purpose flags - attacking
	attack
	
	ai_priority			2.40

	supported_factions		britons, gauls, germans, dacia, scythia, alemanni, spain, slave

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			4
			max_units			7
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third spearmen line
		begin_block 3
			min_units			5
			max_units			7
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block
		
		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		;; right side
		begin_block 6
			max_units			3
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			7 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation

;****************************************************************
;Pseudoromans - Special formation for factions with non-precursor 
;weapons, 2 lines of inf, cav on the wings (created by Sinuhet)
;****************************************************************

begin_formation ai_standard_line_1d

	;;; purpose flags - defending
	defend

	ai_priority			2.8

        supported_factions	britons, gauls, germans, dacia, scythia, alemanni, spain, numidia, slave, carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace


		; Screen of missile inf
		begin_block 0
			max_units			5
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; First line of infantry
		begin_block 1
			min_units			3
			max_units			8
			unit_type			light infantry 1.0
                        unit_type			heavy infantry 0.9
			;default_melee_state	fire_at_will_and_defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -7.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; second line of infantry
		begin_block 2
			min_units			4
			max_units			8
			unit_type			heavy infantry 1.0
			unit_type			light infantry 0.9
			;default_melee_state	fire_at_will_and_defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; 3rd line of infantry, guard of archers
		begin_block 3
			unit_type			non_phalanx_spear 1.0
			unit_type			heavy infantry 0.6
			unit_type			light infantry 0.2
			;default_melee_state	fire_at_will_and_defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		;; Archers behind
		begin_block 4
			max_units			10
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.5
			unit_type			chanting_screeching 0.3
			unit_type			skirmish infantry	0.4
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		begin_dummy_block 5
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 6
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 -10.0 -50.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 10.0 -50.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 8
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 10
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		2 0.0 -50.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 11
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			2 0.0 -70.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 12
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			11 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation ai_standard_line_1a

	;;; purpose flags - approaching
	defend
	attack

	ai_priority			2.8

        supported_factions	britons, gauls, germans, dacia, scythia, alemanni, spain, numidia, slave, carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace


		; Screen of missile inf
		begin_block 0
			max_units			5
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; First line of infantry
		begin_block 1
			min_units			3
			max_units			8
			unit_type			light infantry 1.0
                        unit_type			heavy infantry 0.9
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -7.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; second line of infantry
		begin_block 2
			min_units			4
			max_units			8
			unit_type			heavy infantry 1.0
			unit_type			light infantry 0.9
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; 3rd line of infantry, guard of archers
		begin_block 3
			unit_type			non_phalanx_spear 1.0
			unit_type			heavy infantry 0.6
			unit_type			light infantry 0.2
			;default_melee_state	fire_at_will_and_defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		;; Archers behind
		begin_block 4
			max_units			10
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.5
			unit_type			chanting_screeching 0.3
			unit_type			skirmish infantry	0.4
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		begin_dummy_block 5
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 6
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 -10.0 -50.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 10.0 -50.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 8
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 10
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		2 0.0 -50.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 11
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			2 0.0 -70.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 12
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			11 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation ai_standard_line_1b

	;;; purpose flags
	attack

	ai_priority			2.8

        supported_factions	britons, gauls, germans, dacia, scythia, alemanni, spain, numidia, slave, carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace


		; Screen of missile inf
		begin_block 0
			max_units			5
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; First line of infantry
		begin_block 1
			min_units			3
			max_units			8
			unit_type			light infantry 1.0
                        unit_type			heavy infantry 0.9
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -7.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; second line of infantry
		begin_block 2
			min_units			4
			max_units			8
			unit_type			heavy infantry 1.0
			unit_type			light infantry 0.9
			;default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; 3rd line of infantry, guard of archers
		begin_block 3
			unit_type			non_phalanx_spear 1.0
			unit_type			heavy infantry 0.6
			unit_type			light infantry 0.2
			;default_melee_state	fire_at_will_and_engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		;; Archers behind
		begin_block 4
			max_units			10
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.5
			unit_type			chanting_screeching 0.3
			unit_type			skirmish infantry	0.4
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		begin_dummy_block 5
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 6
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 8
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 10
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		5 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 11
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			5 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 12
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			11 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


;****************************************************************
;****************************************************************
; Romans section
;****************************************************************
;****************************************************************

;****************************************************************
;More historical formation for Romans with premarian units (and 
; other factions with precursor weapons - created by Sinuhet)
;****************************************************************

begin_formation special_Roman_premarian_defend

	;;; purpose flags - defending
	defend

	ai_priority			3.0

        supported_factions	romans_julii, romans_brutii, romans_scipii, romans_senate

		; Screen of skirmish infantry - velites
		begin_block 0
			max_units			5
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; First line of infantry - 1-5x hastati
		begin_block 1
			min_units			1
			max_units			5
			unit_type			light_pilum_infantry 2.0
			;default_melee_state	fire_at_will_and_defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -7.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; Second line of infantry - 1-5x princeps
		begin_block 2
			min_units			1
			max_units			5
			unit_type			heavy_pilum_infantry 2.0
			;default_melee_state	fire_at_will_and_defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; 3rd line of infantry - 1-5x triarii
		begin_block 3
			min_units			1
			max_units			5
			unit_type			non_phalanx_spear 2.0
			;default_melee_state	defend
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; Archers behind
		begin_block 4
			max_units			4
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 5
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		4 0.0 -5.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; artillery and handlers at the back
		begin_block 6
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	5 0.0 -30.0
			inter_unit_spacing	2.0
			priority			0.1
		end_block

		begin_dummy_block 7
			spans 4 5
		end_dummy_block

		;; cavalry on the flanks and back a bit, not_general for all cavalry

		;; left flank cav
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	5 -50.0 -1.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank cav
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	5 50.0 -1.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			6 0.0 -5.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

end_formation


begin_formation special_Roman_premarian_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority			3.0

        supported_factions	romans_julii, romans_brutii, romans_scipii, romans_senate

		; Screen of skirmish infantry - velites
		begin_block 0
			max_units			5
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; First line of infantry - 1-5x hastati
		begin_block 1
			min_units			1
			max_units			5
			unit_type			light_pilum_infantry 2.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -7.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; Second line of infantry - 1-5x princeps
		begin_block 2
			min_units			1
			max_units			5
			unit_type			heavy_pilum_infantry 2.0
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; 3rd line of infantry - 1-5x triarii
		begin_block 3
			min_units			1
			max_units			5
			unit_type			non_phalanx_spear 2.0
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; Archers behind
		begin_block 4
			max_units			4
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 5
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		4 0.0 -5.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; artillery and handlers at the back
		begin_block 6
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	5 0.0 -30.0
			inter_unit_spacing	2.0
			priority			0.1
		end_block

		begin_dummy_block 7
			spans 4 5
		end_dummy_block

		;; cavalry on the flanks and back a bit, not_general for all cavalry

		;; left flank cav
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	5 -50.0 -1.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank cav
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	5 50.0 -1.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			6 0.0 -5.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

end_formation


begin_formation special_Roman_premarian_attack

	;;; purpose flags - attacking
	attack

	ai_priority			3.0

        supported_factions	romans_julii, romans_brutii, romans_scipii, romans_senate

		; Screen of skirmish infantry - velites
		begin_block 0
			max_units			5
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; First line of infantry - 1-5x hastati
		begin_block 1
			min_units			1
			max_units			5
			unit_type			light_pilum_infantry 2.0
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -7.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; Second line of infantry - 1-5x princeps
		begin_block 2
			min_units			1
			max_units			5
			unit_type			heavy_pilum_infantry 2.0
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; 3rd line of infantry - 1-5x triarii
		begin_block 3
			min_units			1
			max_units			5
			unit_type			non_phalanx_spear 2.0
			default_melee_state	engage_at_will
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; Archers behind
		begin_block 4
			max_units			4
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 5
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		4 0.0 -5.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; artillery and handlers at the back
		begin_block 6
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation		line
			block_relative_pos	5 0.0 -30.0
			inter_unit_spacing	2.0
			priority			0.1
		end_block

		begin_dummy_block 7
			spans 1 2 3 4 5 6
		end_dummy_block

		;; cavalry on the flanks and back a bit, not_general for all cavalry

		;; left flank cav
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	5 -50.0 -1.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank cav
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	5 50.0 -1.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			6 0.0 -5.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

end_formation


;****************************************************************
;More historical formation for Romans with postmarian units (and 
; other factions with precursor weapons - created by Sinuhet)
;****************************************************************

begin_formation special_Roman_postmarian_defend

	;;; purpose flags
	defend
	attack

	ai_priority			2.98

        supported_factions	romans_julii, romans_brutii, romans_scipii, romans_senate

		; Screen of missile inf
		begin_block 0
			max_units			4
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; First cohort with Eagle
		begin_block 1
			min_units			1
			max_units			1
			unit_type			heavy_pilum_infantry 2.0
			unit_type			light infantry 1.01
			block_formation		line
			block_relative_pos	0 0.0 -60.0
			inter_unit_spacing	50
			priority			1.0
		end_block

		;; First line of infantry
		begin_block 2
			min_units			3
			max_units			5
			unit_type			heavy_pilum_infantry 1.95
			unit_type			light infantry 2.00
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -10.0
			inter_unit_spacing	20.0
			priority			0.95
		end_block

		;; second line of infantry
		begin_block 3
			min_units			3
			max_units			4
			unit_type			heavy_pilum_infantry 1.95
			unit_type			light infantry 1.10
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	20.0
			priority			0.95
		end_block

		;; 3rd line of infantry left side
		begin_block 4
			max_units			1
			unit_type			heavy_pilum_infantry 1.2
			unit_type			light infantry 1.05
			block_formation		line
			block_relative_pos	1 -50.0 0.0
			inter_unit_spacing	50
			priority			0.10
		end_block

		;; 3rd line of infantry right side
		begin_block 5
			max_units			1
			unit_type			heavy_pilum_infantry 1.2
			unit_type			light infantry 1.05
			block_formation		line
			block_relative_pos	1 50.0 0.0
			inter_unit_spacing	50
			priority			0.10
		end_block

		;; Archers behind 
		begin_block 6
			max_units			4
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 7
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		6 0.0 -5.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; artillery and handlers left side
		begin_block 8
			max_units				1
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	7 -10.0 0.0
			inter_unit_spacing	2.0
			priority			0.1
		end_block

		;; artillery and handlers right side
		begin_block 9
			max_units				1
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	7 10.0 0.0
			inter_unit_spacing	2.0
			priority			0.1
		end_block

		;; cavalry on the flanks

		;; left flank cav
		begin_block 10
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	7 -50.0 0.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank cav
		begin_block 11
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	7 50.0 0.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 12
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	10 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 13
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	11 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; any behind
		begin_block 14
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			7 0.0 -5.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

end_formation


begin_formation special_Roman_postmarian_attack

	;;; purpose flags
	attack

	ai_priority			2.98

        supported_factions	romans_julii, romans_brutii, romans_scipii, romans_senate

		; Screen of missile inf
		begin_block 0
			max_units			4
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; First cohort with Eagle
		begin_block 1
			min_units			1
			max_units			1
			unit_type			heavy_pilum_infantry 2.0
			unit_type			light infantry 1.01
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	0 0.0 -60.0
			inter_unit_spacing	50
			priority			1.0
		end_block

		;; First line of infantry
		begin_block 2
			min_units			3
			max_units			5
			unit_type			heavy_pilum_infantry 1.95
			unit_type			light infantry 2.00
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -10.0
			inter_unit_spacing	20.0
			priority			0.95
		end_block

		;; second line of infantry
		begin_block 3
			min_units			3
			max_units			4
			unit_type			heavy_pilum_infantry 1.95
			unit_type			light infantry 1.10
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	20.0
			priority			0.95
		end_block

		;; 3rd line of infantry left side
		begin_block 4
			max_units			1
			unit_type			heavy_pilum_infantry 1.2
			unit_type			light infantry 1.05
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	1 -50.0 0.0
			inter_unit_spacing	50
			priority			0.10
		end_block

		;; 3rd line of infantry right side
		begin_block 5
			max_units			1
			unit_type			heavy_pilum_infantry 1.2
			unit_type			light infantry 1.05
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	1 50.0 0.0
			inter_unit_spacing	50
			priority			0.10
		end_block

		;; Archers behind 
		begin_block 6
			max_units			4
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 7
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		6 0.0 -5.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; artillery and handlers left side
		begin_block 8
			max_units				1
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation		line
			block_relative_pos	7 -10.0 0.0
			inter_unit_spacing	2.0
			priority			0.1
		end_block

		;; artillery and handlers right side
		begin_block 9
			max_units				1
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation		line
			block_relative_pos	7 10.0 0.0
			inter_unit_spacing	2.0
			priority			0.1
		end_block

		;; cavalry on the flanks

		;; left flank cav
		begin_block 10
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	7 -50.0 0.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank cav
		begin_block 11
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	7 50.0 0.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 12
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	10 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 13
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	11 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; any behind
		begin_block 14
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			7 0.0 -5.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

end_formation


;*********************************************************************************
;More historical formation for Romans with premarian units 
;(and other factions with precursor weapons) - Single line - created by Sinuhet
;*********************************************************************************


begin_formation special_Roman_single_line_defend

	;;; purpose flags
	defend
	attack

	ai_priority			2.25

        supported_factions	romans_julii, romans_brutii, romans_scipii, romans_senate

		;; hastati line
		begin_block 0
			max_units			4
			unit_type			light_pilum_infantry 1.0
			;default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	0.3
			priority			0.9
		end_block

		;; princeps left side
		begin_block 1
			max_units			2
			unit_type			heavy_pilum_infantry 1.0
			;default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	0 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.9
		end_block

		;; princeps right side
		begin_block 2
			max_units			2
			unit_type			heavy_pilum_infantry 1.0
			;default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	0 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.9
		end_block

		;; triarii left side
		begin_block 3
			min_units			3
			max_units			4
			unit_type		non_phalanx_spear 1.0
			;default_melee_state	defend
			block_formation		line
			block_relative_pos	1 -0.3 0.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; triarii right side
		begin_block 4
			min_units			3
			max_units			4
			unit_type		non_phalanx_spear 1.0
			;default_melee_state	defend
			block_formation		line
			block_relative_pos	2 0.3 0.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		begin_dummy_block 5
			spans 0 1 2 3 4
		end_dummy_block

		;; missile troops behind the infantry

		begin_block 6
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	5 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.7
		end_block

		begin_block 7
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	6 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; general
		begin_block 8
			max_units				1
			unit_type				general_unit	1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -5.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; artillery and handler on the sides

		begin_block 9
			unit_type			handler			1.0
			unit_type			siege			1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			8 -10.0 0.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		begin_block 10
			unit_type			handler			1.0
			unit_type			siege			1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			8 10.0 0.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		;; cavalry on the flanks

		;; left flank
		begin_block 11
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank
		begin_block 12
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	10 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; left flank missile cav
		begin_block 13
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	11 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.7
		end_block

		;; right_flank missile cav
		begin_block 14
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	12 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.7
		end_block

		begin_dummy_block 15
			spans 8 9 10 11 12 13 14
		end_dummy_block

		;; any behind
		begin_block 16
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			15 0.0 -5.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

end_formation


begin_formation special_Roman_single_line_attack

	;;; purpose flags
	attack

	ai_priority			2.25

        supported_factions	romans_julii, romans_brutii, romans_scipii, romans_senate

		;; hastati line
		begin_block 0
			max_units			4
			unit_type			light_pilum_infantry 1.0
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	0.3
			priority			0.9
		end_block

		;; princeps left side
		begin_block 1
			max_units			2
			unit_type			heavy_pilum_infantry 1.0
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	0 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.9
		end_block

		;; princeps right side
		begin_block 2
			max_units			2
			unit_type			heavy_pilum_infantry 1.0
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	0 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.9
		end_block

		;; triarii left side
		begin_block 3
			min_units			3
			max_units			4
			unit_type		non_phalanx_spear 1.0
			;default_melee_state	engage_at_will
			block_formation		line
			block_relative_pos	1 -0.3 0.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; triarii right side
		begin_block 4
			min_units			3
			max_units			4
			unit_type		non_phalanx_spear 1.0
			;default_melee_state	engage_at_will
			block_formation		line
			block_relative_pos	2 0.3 0.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		begin_dummy_block 5
			spans 0 1 2 3 4
		end_dummy_block

		;; missile troops behind the infantry

		begin_block 6
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			block_formation		line
			block_relative_pos	5 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.7
		end_block

		begin_block 7
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
			block_formation		line
			block_relative_pos	6 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; general
		begin_block 8
			max_units				1
			unit_type				general_unit	1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -5.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; artillery and handler on the sides

		begin_block 9
			unit_type			handler			1.0
			unit_type			siege			1.0
			block_formation				line
			block_relative_pos			8 -10.0 0.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		begin_block 10
			unit_type			handler			1.0
			unit_type			siege			1.0
			block_formation				line
			block_relative_pos			8 10.0 0.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		;; cavalry on the flanks

		;; left flank
		begin_block 11
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank
		begin_block 12
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	10 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; left flank missile cav
		begin_block 13
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	11 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.7
		end_block

		;; right_flank missile cav
		begin_block 14
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	12 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.7
		end_block

		begin_dummy_block 15
			spans 8 9 10 11 12 13 14
		end_dummy_block

		;; any behind
		begin_block 16
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			15 0.0 -5.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

end_formation


;****************************************************************************
;More historical formation for Romans with postmarian units 
; (and other factions with precursor weapons) - Wedge - created by Sinuhet
;****************************************************************************


begin_formation special_Roman_wedge_defend

	;;; purpose flags
	defend
	attack

	ai_priority			2.98

        supported_factions	romans_julii, romans_brutii, romans_scipii, romans_senate

		;; First cohort with Eagle
		begin_block 0
			min_units			1
			max_units			1
			unit_type			heavy_pilum_infantry 1.0
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	1.0
			priority			1.0
		end_block

		;; First line of infantry
		begin_block 1
			min_units			1
			max_units			1
			unit_type			heavy_pilum_infantry 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 70.0
			inter_unit_spacing	1.0
			priority			0.95
		end_block

		;; second line of infantry
		begin_block 2
			min_units			3
			max_units			3
			unit_type			heavy_pilum_infantry 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -5.0
			inter_unit_spacing	1.0
			priority			0.95
		end_block

		;; 3rd line of infantry
		begin_block 3
			min_units			5
			max_units			5
			unit_type			heavy_pilum_infantry 1.0
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	1.0
			priority			0.9
		end_block

		;; 4th line of infantry
		begin_block 4
			min_units			3
			max_units			7
			unit_type			heavy_pilum_infantry 1.0
			block_formation		line
			block_relative_pos	3 0.0 -5.0
			inter_unit_spacing	1.0
			priority			0.9
		end_block

		;; general at the back, inserted by Sinuhet
		begin_block 5
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		0 0.0 -5.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; cavalry on the flanks

		;; left flank cav
		begin_block 6
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 -10.0 0.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank cav
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 10.0 0.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 8
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	6 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	7 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; Line of missile inf
		begin_block 10
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	5 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; Archers behind
		begin_block 11
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend_and_skirmish
			block_formation		line
			block_relative_pos	10 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; artillery and handlers at the back
		begin_block 12
			unit_type			handler				1.0
			unit_type			siege				1.0
			unit_type			any					0.01
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	11 0.0 -20.0
			inter_unit_spacing	2.0
			priority			0.1
		end_block

end_formation


begin_formation special_Roman_wedge_attack

	;;; purpose flags
	attack

	ai_priority			2.98

        supported_factions	romans_julii, romans_brutii, romans_scipii, romans_senate

		;; First cohort with Eagle
		begin_block 0
			min_units			1
			max_units			1
			unit_type			heavy_pilum_infantry 1.0
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	1.0
			priority			1.0
		end_block

		;; First line of infantry
		begin_block 1
			min_units			1
			max_units			1
			unit_type			heavy_pilum_infantry 1.0
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 70.0
			inter_unit_spacing	1.0
			priority			0.95
		end_block

		;; second line of infantry
		begin_block 2
			min_units			3
			max_units			3
			unit_type			heavy_pilum_infantry 1.0
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -5.0
			inter_unit_spacing	1.0
			priority			0.95
		end_block

		;; 3rd line of infantry
		begin_block 3
			min_units			5
			max_units			5
			unit_type			heavy_pilum_infantry 1.0
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	1.0
			priority			0.9
		end_block

		;; 4th line of infantry
		begin_block 4
			min_units			3
			max_units			7
			unit_type			heavy_pilum_infantry 1.0
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	3 0.0 -5.0
			inter_unit_spacing	1.0
			priority			0.9
		end_block

		;; general at the back, inserted by Sinuhet
		begin_block 5
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		0 0.0 -5.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; cavalry on the flanks

		;; left flank cav
		begin_block 6
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 -10.0 0.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank cav
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 10.0 0.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 8
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	6 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	7 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; Line of missile inf
		begin_block 10
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	5 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; Archers behind
		begin_block 11
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
			block_formation		line
			block_relative_pos	10 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; artillery and handlers at the back
		begin_block 12
			unit_type			handler				1.0
			unit_type			siege				1.0
			unit_type			any					0.01
			block_formation		line
			block_relative_pos	11 0.0 -20.0
			inter_unit_spacing	2.0
			priority			0.1
		end_block

end_formation


;**************************************************************************************************
; Non-phalanx spearmen double line Roman formation, min 9, max 12 spearmen units (created by Sinuhet)
;**************************************************************************************************

begin_formation roman_nonphalanx_1d

	;;; purpose flags - defending
	defend
	
	ai_priority			2.10

	supported_factions		romans_julii, romans_brutii, romans_scipii, romans_senate

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			5
			max_units			6
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 3
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 4
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 6
			spans 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 11
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		2 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			2 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			12 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation roman_nonphalanx_1a

	;;; purpose flags - approaching
	defend
	attack
	
	ai_priority			2.10

	supported_factions		romans_julii, romans_brutii, romans_scipii, romans_senate

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			5
			max_units			6
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 3
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 4
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 6
			spans 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 11
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		2 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			2 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			12 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation roman_nonphalanx_1b

	;;; purpose flags - attacking
	attack

	ai_priority			2.10

	supported_factions		romans_julii, romans_brutii, romans_scipii, romans_senate

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			5
			max_units			6
			unit_type			non_phalanx_spear 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 3
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 4
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 6
			spans 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 11
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		6 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 12
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			6 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 13
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			12 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


;**************************************************************************************************
; Non-phalanx spearmen triple line Roman formation, max 13 spearmen units (created by Sinuhet)
;**************************************************************************************************

begin_formation roman_nonphalanx_2d

	;;; purpose flags - defending
	defend
	
	ai_priority			2.20

	supported_factions		romans_julii, romans_brutii, romans_scipii, romans_senate

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			4
			max_units			7
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third spearmen line
		begin_block 3
			min_units			5
			max_units			7
			unit_type			non_phalanx_spear 1.0
			default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 6
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		3 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			3 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation roman_nonphalanx_2a

	;;; purpose flags - approaching
	defend
	attack
	
	ai_priority			2.20

	supported_factions		romans_julii, romans_brutii, romans_scipii, romans_senate

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			4
			max_units			7
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third spearmen line
		begin_block 3
			min_units			5
			max_units			7
			unit_type			non_phalanx_spear 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 6
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		3 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			3 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation roman_nonphalanx_2b

	;;; purpose flags - attacking
	attack

	ai_priority			2.20

	supported_factions		romans_julii, romans_brutii, romans_scipii, romans_senate

		; Screen of missile inf
		begin_block 0
			max_units			8			
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block
		
		;; first spearmen line
		begin_block 1
			min_units			4
			max_units			6
			unit_type			non_phalanx_spear 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; second spearmen line
		begin_block 2
			min_units			4
			max_units			7
			unit_type			non_phalanx_spear 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -15.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; third spearmen line
		begin_block 3
			min_units			5
			max_units			7
			unit_type			non_phalanx_spear 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; archers behind the spearmen

		begin_block 4
			max_units			5
			unit_type			ranged_missile_infantry 1.0			
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 5
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 -1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		;; right side
		begin_block 6
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	1 1.5 0.0
			inter_unit_spacing	2.0
			priority			0.8
		end_block

		begin_dummy_block 7
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 9
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	8 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 11
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	9 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 12
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 13
			max_units			0
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			7 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 14
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			13 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


;****************************************************************
; Special formation with precursor weapons, 3 lines of inf,
; cav on the wings - adapted by Sinuhet
;****************************************************************

begin_formation ai_precursor_line_defend

	;;; purpose flags - defending
	defend

	ai_priority			2.0

        supported_factions	romans_julii, romans_brutii, romans_scipii, romans_senate


		; Screen of missile inf
		begin_block 0
			max_units			5
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; First line of infantry
		begin_block 1
			unit_type			light_pilum_infantry 1.0
			unit_type			light infantry 1.0
			unit_type			heavy_pilum_infantry 0.9
                        unit_type			heavy infantry 0.9
			;default_melee_state	fire_at_will_and_defend
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -7.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; second line of infantry
		begin_block 2
			unit_type			heavy_pilum_infantry 1.0
			unit_type			heavy infantry 1.0
			unit_type			light_pilum_infantry 0.9
			unit_type			light infantry 0.9
			;default_melee_state	fire_at_will_and_defend
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; 3rd line of infantry, guard of archers
		begin_block 3
			unit_type			non_phalanx_spear 1.0
			unit_type			heavy_pilum_infantry 0.6
			unit_type			heavy infantry 0.6
			unit_type			light_pilum_infantry 0.2
			unit_type			light infantry 0.2
			;default_melee_state	fire_at_will_and_defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		;; Archers behind
		begin_block 4
			max_units			10
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.5
			unit_type			skirmish infantry	0.4
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		begin_dummy_block 5
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 6
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 -10.0 -50.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 10.0 -50.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 8
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 10
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		2 0.0 -50.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 11
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			2 0.0 -70.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 12
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			11 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation ai_precursor_line_approach

	;;; purpose flags - approaching
	defend
	attack

	ai_priority			2.0

        supported_factions	romans_julii, romans_brutii, romans_scipii, romans_senate


		; Screen of missile inf
		begin_block 0
			max_units			5
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; First line of infantry
		begin_block 1
			unit_type			light_pilum_infantry 1.0
			unit_type			light infantry 1.0
			unit_type			heavy_pilum_infantry 0.9
                        unit_type			heavy infantry 0.9
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -7.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; second line of infantry
		begin_block 2
			unit_type			heavy_pilum_infantry 1.0
			unit_type			heavy infantry 1.0
			unit_type			light_pilum_infantry 0.9
			unit_type			light infantry 0.9
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; 3rd line of infantry, guard of archers
		begin_block 3
			unit_type			non_phalanx_spear 1.0
			unit_type			heavy_pilum_infantry 0.6
			unit_type			heavy infantry 0.6
			unit_type			light_pilum_infantry 0.2
			unit_type			light infantry 0.2
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		;; Archers behind
		begin_block 4
			max_units			10
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.5
			unit_type			skirmish infantry	0.4
			default_melee_state	fire_at_will_and_defend
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		begin_dummy_block 5
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 6
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 -10.0 -50.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 10.0 -50.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 8
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 10
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		2 0.0 -50.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 11
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			2 0.0 -70.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 12
			unit_type			handler				1.0
			unit_type			siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			11 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation ai_precursor_line_attack

	;;; purpose flags - attacking
	attack

	ai_priority			2.0

        supported_factions	romans_julii, romans_brutii, romans_scipii, romans_senate


		; Screen of missile inf
		begin_block 0
			max_units			5
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			0.6
		end_block

		;; First line of infantry
		begin_block 1
			unit_type			light_pilum_infantry 1.0
			unit_type			light infantry 1.0
			unit_type			heavy_pilum_infantry 0.9
                        unit_type			heavy infantry 0.9
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -7.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; second line of infantry
		begin_block 2
			unit_type			heavy_pilum_infantry 1.0
			unit_type			heavy infantry 1.0
			unit_type			light_pilum_infantry 0.9
			unit_type			light infantry 0.9
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

		;; 3rd line of infantry, guard of archers
		begin_block 3
			unit_type			non_phalanx_spear 1.0
			unit_type			heavy_pilum_infantry 0.6
			unit_type			heavy infantry 0.6
			unit_type			light_pilum_infantry 0.2
			unit_type			light infantry 0.2
			default_melee_state	fire_at_will_and_engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	0.3
			priority			0.8
		end_block

		;; Archers behind
		begin_block 4
			max_units			10
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.5
			unit_type			skirmish infantry	0.4
			default_melee_state	fire_at_will_and_skirmish
                        max_unit_width		40
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		begin_dummy_block 5
			spans 1 2 3
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 6
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 8
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	7 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 10
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		5 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 11
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			5 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 12
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			11 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


;****************************************************************
;****************************************************************
; Special missile formations section
;****************************************************************
;****************************************************************

;****************************************************************
; Missile troops without infantry formation (created by Sinuhet)
;****************************************************************

begin_formation missile_and_cavalry_army_defend

	;;; purpose flags
	defend
	attack
	
	ai_priority			3.6

        supported_factions	carthage, numidia, pontus, armenia

		; Screen of missile cavalry
		begin_block 0
			not_general
			unit_type			missile cavalry 0.7
			default_melee_state	fire_at_will_and_defend_and_skirmish
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	4.0
			priority			0.7
		end_block
		
		;; first missile units group
		begin_block 1
			max_units			1
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -20.0
			inter_unit_spacing	2.0
			priority			0.86
		end_block

		;; second missile units group
		begin_block 2
			max_units			2
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -20.0
			inter_unit_spacing	2.0
			priority			0.87
		end_block

		;; third missile units group
		begin_block 3
			max_units			1
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	2 -2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.88
		end_block

		begin_block 4
			max_units			1
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	2 2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.88
		end_block

		;; 4th missile units group
		begin_block 5
			max_units			1
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	3 -2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.89
		end_block

		begin_block 6
			max_units			1
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	4 2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.89
		end_block

		;; 5th missile units group
		begin_block 7
			max_units			1
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	5 -2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.9
		end_block

		begin_block 8
			max_units			1
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	6 2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.9
		end_block

		begin_dummy_block 9
			spans 1 2 3 4 5 6 7 8
		end_dummy_block
		
		;; spearmen line
		begin_block 10
			max_units			0
			unit_type			phalanx 0.70
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 0.0 -20.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		begin_block 11
			max_units			0
			unit_type			non_phalanx_spear 0.70
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	10 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		begin_block 12
			max_units			0
			unit_type			non_phalanx_spear 0.70
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	10 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; missile troops behind the spearmen
		begin_block 13
			max_units			2
			unit_type			ranged_missile_infantry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			block_formation		line
			block_relative_pos	10 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 14
			max_units			0
			unit_type			heavy infantry 0.70
			block_formation		line
			block_relative_pos	11 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; right side
		begin_block 15
			max_units			0
			unit_type			heavy infantry 0.70
			block_formation		line
			block_relative_pos	12 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; left side
		begin_block 16
			max_units			0
			unit_type			light infantry 0.70
			block_formation		line
			block_relative_pos	14 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; right side
		begin_block 17
			max_units			0
			unit_type			light infantry 0.70
			block_formation		line
			block_relative_pos	15 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; general at the back
		begin_block 18
			max_units				1
			unit_type				general_unit	1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		13 0.0 -5.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; cavalry on the flanks

		;; left flank
		begin_block 19
			not_general
			unit_type			cavalry 0.5
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	18 -15.0 0.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 20
			not_general
			unit_type			cavalry 0.5
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	18 15.0 0.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; artillery and handler behind
		begin_block 21
			unit_type			handler			1.0
			unit_type			siege			1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			18 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		;; back line of other units
		begin_block 22
			max_units				0
			unit_type			any			1.0
			block_formation				line
			block_relative_pos			21 0.0 -10.0
			inter_unit_spacing			0.3
			priority					1.0
		end_block

end_formation


begin_formation missile_and_cavalry_army_attack

	;;; purpose flags
	attack
	
	ai_priority			3.6

        supported_factions	carthage, numidia, pontus, armenia

		; Screen of missile cavalry
		begin_block 0
			not_general
			unit_type			missile cavalry 0.7
			default_melee_state	fire_at_will_and_skirmish
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	4.0
			priority			0.7
		end_block
		
		;; first missile units group
		begin_block 1
			max_units			1
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -20.0
			inter_unit_spacing	2.0
			priority			0.86
		end_block

		;; second missile units group
		begin_block 2
			max_units			2
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -20.0
			inter_unit_spacing	2.0
			priority			0.87
		end_block

		;; third missile units group
		begin_block 3
			max_units			1
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	2 -2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.88
		end_block

		begin_block 4
			max_units			1
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	2 2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.88
		end_block

		;; 4th missile units group
		begin_block 5
			max_units			1
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	3 -2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.89
		end_block

		begin_block 6
			max_units			1
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	4 2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.89
		end_block

		;; 5th missile units group
		begin_block 7
			max_units			1
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	5 -2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.9
		end_block

		begin_block 8
			max_units			1
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	6 2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.9
		end_block

		begin_dummy_block 9
			spans 1 2 3 4 5 6 7 8
		end_dummy_block
		
		;; spearmen line
		begin_block 10
			max_units			0
			unit_type			phalanx 0.70
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 0.0 -20.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		begin_block 11
			max_units			0
			unit_type			non_phalanx_spear 0.70
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	10 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		begin_block 12
			max_units			0
			unit_type			non_phalanx_spear 0.70
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	10 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; missile troops behind the spearmen
		begin_block 13
			max_units			2
			unit_type			ranged_missile_infantry 1.0
			default_melee_state	fire_at_will_and_skirmish
			block_formation		line
			block_relative_pos	10 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 14
			max_units			0
			unit_type			heavy infantry 0.70
			block_formation		line
			block_relative_pos	11 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; right side
		begin_block 15
			max_units			0
			unit_type			heavy infantry 0.70
			block_formation		line
			block_relative_pos	12 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; left side
		begin_block 16
			max_units			0
			unit_type			light infantry 0.70
			block_formation		line
			block_relative_pos	14 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; right side
		begin_block 17
			max_units			0
			unit_type			light infantry 0.70
			block_formation		line
			block_relative_pos	15 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; general at the back
		begin_block 18
			max_units				1
			unit_type				general_unit	1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		13 0.0 -5.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; cavalry on the flanks

		;; left flank
		begin_block 19
			not_general
			unit_type			cavalry 0.5
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	18 -15.0 0.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 20
			not_general
			unit_type			cavalry 0.5
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	18 15.0 0.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; artillery and handler behind
		begin_block 21
			unit_type			handler			1.0
			unit_type			siege			1.0
			block_formation				line
			block_relative_pos			18 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		;; back line of other units
		begin_block 22
			max_units				0
			unit_type			any			1.0
			block_formation				line
			block_relative_pos			21 0.0 -10.0
			inter_unit_spacing			0.3
			priority					1.0
		end_block

end_formation


;****************************************************************
; Missile troops army defensive formation (created by Sinuhet)
;****************************************************************

begin_formation missile_defend_1

	;;; purpose flags
	defend
	
	ai_priority			3.5


		; Screen of missile cavalry
		begin_block 0
			not_general
			unit_type			missile cavalry 0.7
			default_melee_state	fire_at_will_and_defend_and_skirmish
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	4.0
			priority			0.7
		end_block
		
		;; first missile units group
		begin_block 1
			min_units			1
			max_units			1
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -20.0
			inter_unit_spacing	2.0
			priority			0.86
		end_block

		;; second missile units group
		begin_block 2
			min_units			3
			max_units			3
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -20.0
			inter_unit_spacing	2.0
			priority			0.87
		end_block

		;; third missile units group
		begin_block 3
			min_units			1
			max_units			2
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	2 -2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.88
		end_block

		begin_block 4
			min_units			1
			max_units			2
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	2 2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.88
		end_block

		;; 4th missile units group
		begin_block 5
			min_units			1
			max_units			2
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	3 -2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.89
		end_block

		begin_block 6
			min_units			1
			max_units			2
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	4 2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.89
		end_block

		;; 5th missile units group
		begin_block 7
			min_units			1
			max_units			2
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	5 -2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.9
		end_block

		begin_block 8
			min_units			1
			max_units			2
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	6 2.0 -20.0
			inter_unit_spacing	2.0
			priority			0.9
		end_block

		begin_dummy_block 9
			spans 1 2 3 4 5 6 7 8
		end_dummy_block
		
		;; spearmen line
		begin_block 10
			unit_type			phalanx 0.70
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 0.0 -20.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		begin_block 11
			unit_type			non_phalanx_spear 0.70
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	10 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		begin_block 12
			unit_type			non_phalanx_spear 0.70
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	10 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; missile troops behind the spearmen
		begin_block 13
			min_units			2
			max_units			4
			unit_type			ranged_missile_infantry 1.0
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	10 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 14
			unit_type			heavy infantry 0.70
			;default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	11 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; right side
		begin_block 15
			unit_type			heavy infantry 0.70
			;default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	12 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; left side
		begin_block 16
			unit_type			light infantry 0.70
			;default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	14 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; right side
		begin_block 17
			unit_type			light infantry 0.70
			;default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	15 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; general at the back
		begin_block 18
			max_units				1
			unit_type				general_unit	1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		13 0.0 -5.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; cavalry on the flanks

		;; left flank
		begin_block 19
			not_general
			unit_type			cavalry 0.5
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	18 -15.0 0.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 20
			not_general
			unit_type			cavalry 0.5
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	18 15.0 0.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; artillery and handler behind
		begin_block 21
			unit_type			handler			1.0
			unit_type			siege			1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			18 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		;; back line of other units
		begin_block 22
			max_units				0
			unit_type			any			1.0
			block_formation				line
			block_relative_pos			21 0.0 -10.0
			inter_unit_spacing			0.3
			priority					1.0
		end_block

end_formation

;****************************************************************
; Missile troops army attack formation (created by Sinuhet)
;****************************************************************

begin_formation missile_attack_1

	;;; purpose flags
	attack
	
	ai_priority			3.5


		; Screen of missile cavalry
		begin_block 0
			not_general
			unit_type			missile cavalry 0.7
			default_melee_state	fire_at_will_and_skirmish
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	4.0
			priority			0.7
		end_block
		


		;; first missile units group
		begin_block 1
			min_units			1
			max_units			2
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	0 -75.0 -20.0
			inter_unit_spacing	2.0
			priority			0.9
		end_block

		begin_block 2
			min_units			1
			max_units			2
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	0 75.0 -20.0
			inter_unit_spacing	2.0
			priority			0.9
		end_block

		;; second missile units group
		begin_block 3
			min_units			1
			max_units			2
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.89
		end_block

		begin_block 4
			min_units			1
			max_units			2
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.89
		end_block

		;; third missile units group
		begin_block 5
			min_units			1
			max_units			2
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	3 0.0 -20.0
			inter_unit_spacing	2.0
			priority			0.88
		end_block

		begin_block 6
			min_units			1
			max_units			2
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	4 0.0 -20.0
			inter_unit_spacing	2.0
			priority			0.88
		end_block

		;; 4th missile units group
		begin_block 7
			min_units			1
			max_units			1
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -80.0
			inter_unit_spacing	2.0
			priority			0.86
		end_block

		;; 5th missile units group
		begin_block 8
			min_units			3
			max_units			3
			unit_type			skirmish infantry	1.0
			unit_type			chanting_screeching 0.9
			unit_type			missile infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	7 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.87
		end_block

		begin_dummy_block 9
			spans 1 2 3 4 5 6 7 8
		end_dummy_block
		
		;; spearmen line
		begin_block 10
			unit_type			phalanx 0.70
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 0.0 -20.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		begin_block 11
			unit_type			non_phalanx_spear 0.70
			;default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	10 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		begin_block 12
			unit_type			non_phalanx_spear 0.70
			;default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	10 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; missile troops behind the spearmen
		begin_block 13
			min_units			2
			unit_type			ranged_missile_infantry 1.0
			default_melee_state	fire_at_will_and_skirmish
			block_formation		line
			block_relative_pos	10 0.0 -10.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 14
			unit_type			heavy infantry 0.70
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	11 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; right side
		begin_block 15
			unit_type			heavy infantry 0.70
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	12 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; left side
		begin_block 16
			unit_type			light infantry 0.70
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	14 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; right side
		begin_block 17
			unit_type			light infantry 0.70
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	15 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.70
		end_block

		;; general at the back
		begin_block 18
			max_units				1
			unit_type				general_unit	1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		13 0.0 -5.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; cavalry on the flanks

		;; left flank
		begin_block 19
			not_general
			unit_type			cavalry 0.5
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	18 -15.0 0.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 20
			not_general
			unit_type			cavalry 0.5
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	18 15.0 0.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; artillery and handler behind
		begin_block 21
			unit_type			handler			1.0
			unit_type			siege			1.0
			block_formation				line
			block_relative_pos			18 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		;; back line of other units
		begin_block 22
			max_units				0
			unit_type			any			1.0
			block_formation				line
			block_relative_pos			21 0.0 -10.0
			inter_unit_spacing			0.3
			priority					1.0
		end_block

end_formation

;*******************************
;*******************************
; Formations for cavalry armies
;*******************************
;*******************************

;****************************************************************
; Formation for missile cav armies - created by Sinuhet
;****************************************************************

begin_formation ai_missile_cavalry_defense 

	;;; purpose flags
	attack
	defend

	ai_priority			3.8

        supported_factions	scythia, alemanni, numidia, carthage, pontus, armenia, egypt, seleucid

		; screen
		begin_block 0
			min_units			1
			max_units			3
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; light cav on either wing

		;; left side
		begin_block 1
			max_units			2
			not_general
			unit_type		missile cavalry 	1.0
			unit_type		elephants		1.0
			unit_type		heavy_chariots		1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 -5.0 -10.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; right side
		begin_block 2
			max_units			2
			not_general
			unit_type		missile cavalry 	1.0
			unit_type		elephants		1.0
			unit_type		heavy_chariots		1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 5.0 -10.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; Light cav reserves for either wing
		;; left side
		begin_block 3
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			max_unit_width		40
			block_formation		column
			block_relative_pos	1 0.0 -60.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; right side
		begin_block 4
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			max_unit_width		40
			block_formation		column
			block_relative_pos	2 0.0 -60.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; cav behind centre
		begin_block 5
			not_general
			unit_type			cavalry 0.7
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.1
		end_block

		begin_block 6
			not_general
			unit_type			cavalry 0.7
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	4 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.1
		end_block

		;; Cavalry centre
		begin_block 7
			max_units			6
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 0.8
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -65.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; general at the back
		begin_block 8
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -10.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; artillery and handler behind
		begin_block 9
			not_general
			unit_type					handler				1.0
			unit_type					siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			8 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		begin_block 10
			max_units			0
			not_general
			unit_type			any 1.0
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 0.0 -20.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

end_formation


begin_formation ai_missile_cavalry_attack 

	;;; purpose flags
	attack

	ai_priority			3.8

        supported_factions	scythia, alemanni, numidia, carthage, pontus, armenia, egypt, seleucid

		; screen
		begin_block 0
			min_units			1
			max_units			3
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; light cav on either wing

		;; left side
		begin_block 1
			max_units			2
			not_general
			unit_type		missile cavalry 	1.0
			unit_type		elephants		1.0
			unit_type		heavy_chariots		1.0
			default_melee_state	fire_at_will_and_engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 -5.0 -10.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; right side
		begin_block 2
			max_units			2
			not_general
			unit_type		missile cavalry 	1.0
			unit_type		elephants		1.0
			unit_type		heavy_chariots		1.0
			default_melee_state	fire_at_will_and_engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 5.0 -10.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; Light cav reserves for either wing
		;; left side
		begin_block 3
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			max_unit_width		40
			block_formation		column
			block_relative_pos	1 0.0 -60.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; right side
		begin_block 4
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			max_unit_width		40
			block_formation		column
			block_relative_pos	2 0.0 -60.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; cav behind centre
		begin_block 5
			not_general
			unit_type			cavalry 0.7
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.1
		end_block

		begin_block 6
			not_general
			unit_type			cavalry 0.7
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	4 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.1
		end_block

		;; Cavalry centre
		begin_block 7
			max_units			6
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 0.8
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -65.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; general at the back
		begin_block 8
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish 
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; artillery and handler behind
		begin_block 9
			not_general
			unit_type					handler				1.0
			unit_type					siege				1.0
			default_melee_state	hold_fire_and_defend 
			block_formation				line
			block_relative_pos			8 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		begin_block 10
			max_units			0
			not_general
			unit_type			any 1.0
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 0.0 -20.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

end_formation


;****************************************************************
; Formation for horse archers armies - created by Sinuhet
;****************************************************************

begin_formation ai_horse_archers_defense 

	;;; purpose flags
	attack
	defend

	ai_priority			3.8

        supported_factions	scythia, alemanni

		; screen
		begin_block 0
			min_units			3
			max_units			3
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; light cav on either wing

		;; left side
		begin_block 1
			min_units			1
			max_units			2
			not_general
			unit_type		missile cavalry 	1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 -5.0 -5.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

		;; right side
		begin_block 2
			min_units			1
			max_units			2
			not_general
			unit_type		missile cavalry 	1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 5.0 -5.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

		;; Light cav reserves for either wing
		;; left side
		begin_block 3
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 0.0 -50.0
			inter_unit_spacing	3.0
			priority			0.3
		end_block

		;; right side
		begin_block 4
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 0.0 -50.0
			inter_unit_spacing	3.0
			priority			0.3
		end_block

		;; cav behind centre
		begin_block 5
			not_general
			unit_type			cavalry 0.7
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -5.0 0.0
			inter_unit_spacing	3.0
			priority			0.1
		end_block

		begin_block 6
			not_general
			unit_type			cavalry 0.7
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	4 5.0 0.0
			inter_unit_spacing	3.0
			priority			0.1
		end_block

		;; Cavalry centre
		begin_block 7
			min_units			1
			max_units			6
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 0.8
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -50.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; general at the back
		begin_block 8
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -10.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block


		;; spearmen line
		begin_block 9
			max_units		7
			unit_type		phalanx 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	7 0.0 -20.0
			inter_unit_spacing	0.3
			priority			0.90
		end_block

		begin_block 10
			max_units		7
			unit_type		non_phalanx_spear 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 0.0 -5.0
			inter_unit_spacing	0.3
			priority			0.90
		end_block

		;; heavy and other infantry

		;; heavy infantry
		begin_block 11
			max_units			6
                        unit_type			heavy infantry 1.0
			unit_type			light infantry 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	10 0.0 -5.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		;; missile troops behind the spearmen and other infantry
		begin_block 12
			max_units			6
			unit_type			ranged_missile_infantry 0.9			
			unit_type			missile infantry	1.0
			unit_type			skirmish infantry	0.8
			default_melee_state	fire_at_will_and_defend
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	11 0.0 -5.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		begin_block 13
			max_units			6
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.9
			unit_type			chanting_screeching 0.5
			unit_type			skirmish infantry	0.8
			default_melee_state	fire_at_will_and_defend
			unit_density		close
			max_unit_width		40
			block_formation		line
			block_relative_pos	12 0.0 -5.0
			inter_unit_spacing	1.0
			priority			1.0
		end_block

		;; artillery and handler behind
		begin_block 14
			not_general
			unit_type					handler				1.0
			unit_type					siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -5.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		begin_block 15
			max_units			0
			not_general
			unit_type			any 1.0
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	14 0.0 -0.5
			inter_unit_spacing	0.3
			priority			1.0
		end_block

end_formation


begin_formation ai_horse_archers_attack 

	;;; purpose flags
	attack

	ai_priority			3.8

        supported_factions	scythia, alemanni

		; screen
		begin_block 0
			min_units			3
			max_units			3
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; light cav on either wing

		;; left side
		begin_block 1
			min_units			1
			max_units			2
			not_general
			unit_type		missile cavalry 	1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 -5.0 -5.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

		;; right side
		begin_block 2
			min_units			1
			max_units			2
			not_general
			unit_type		missile cavalry 	1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 5.0 -5.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

		;; Light cav reserves for either wing
		;; left side
		begin_block 3
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 0.0 -50.0
			inter_unit_spacing	3.0
			priority			0.3
		end_block

		;; right side
		begin_block 4
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 0.0 -50.0
			inter_unit_spacing	3.0
			priority			0.3
		end_block

		;; cav behind centre
		begin_block 5
			not_general
			unit_type			cavalry 0.7
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -5.0 0.0
			inter_unit_spacing	3.0
			priority			0.1
		end_block

		begin_block 6
			not_general
			unit_type			cavalry 0.7
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	4 5.0 0.0
			inter_unit_spacing	3.0
			priority			0.1
		end_block

		;; Cavalry centre
		begin_block 7
			min_units			1
			max_units			6
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 0.8
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -50.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; general at the back
		begin_block 8
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -10.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block


		;; spearmen line
		begin_block 9
			max_units		7
			unit_type		phalanx 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	7 0.0 -20.0
			inter_unit_spacing	0.3
			priority			0.90
		end_block

		begin_block 10
			max_units		7
			unit_type		non_phalanx_spear 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 0.0 -5.0
			inter_unit_spacing	0.3
			priority			0.90
		end_block

		;; heavy and other infantry

		;; heavy infantry
		begin_block 11
			max_units			6
                        unit_type			heavy infantry 1.0
			unit_type			light infantry 1.0
			default_melee_state	engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	10 0.0 -5.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		;; missile troops behind the spearmen and other infantry
		begin_block 12
			max_units			6
			unit_type			ranged_missile_infantry 0.9			
			unit_type			missile infantry	1.0
			unit_type			skirmish infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	11 0.0 -5.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		begin_block 13
			max_units			6
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.9
			unit_type			chanting_screeching 0.5
			unit_type			skirmish infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			max_unit_width		40
			block_formation		line
			block_relative_pos	12 0.0 -5.0
			inter_unit_spacing	1.0
			priority			1.0
		end_block

		;; artillery and handler behind
		begin_block 14
			not_general
			unit_type					handler				1.0
			unit_type					siege				1.0
			default_melee_state	hold_fire_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -5.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		begin_block 15
			max_units			0
			not_general
			unit_type			any 1.0
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	14 0.0 -0.5
			inter_unit_spacing	0.3
			priority			1.0
		end_block

end_formation


;****************************************************************
; Formation for mixed missile cavalry armies - created by Sinuhet
;****************************************************************

begin_formation ai_mixed_missile_cavalry_defense 

	;;; purpose flags
	attack
	defend

	ai_priority			3.8

        supported_factions	parthia, numidia, carthage, pontus, armenia, egypt, seleucid

		; screen
		begin_block 0
			min_units			3
			max_units			3
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; light cav on either wing

		;; left side
		begin_block 1
			max_units			2
			not_general
			unit_type		elephants		1.0
			unit_type		heavy_chariots		1.0
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	0 -5.0 -5.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

		;; right side
		begin_block 2
			max_units			2
			not_general
			unit_type		elephants		1.0
			unit_type		heavy_chariots		1.0
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	0 5.0 -5.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

		;; Light cav reserves for either wing
		;; left side
		begin_block 3
			min_units			1
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 -30.0 -80.0
			inter_unit_spacing	3.0
			priority			0.3
		end_block

		;; right side
		begin_block 4
			min_units			1
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 30.0 -80.0
			inter_unit_spacing	3.0
			priority			0.3
		end_block

		;; cav behind centre
		begin_block 5
			not_general
			unit_type			cavalry 0.7
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -5.0 0.0
			inter_unit_spacing	3.0
			priority			0.1
		end_block

		begin_block 6
			not_general
			unit_type			cavalry 0.7
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	4 5.0 0.0
			inter_unit_spacing	3.0
			priority			0.1
		end_block

		;; Cavalry centre
		begin_block 7
			min_units			3
			max_units			6
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 0.8
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -50.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; general at the back
		begin_block 8
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -10.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block


		;; spearmen line
		begin_block 9
			max_units		7
			unit_type		phalanx 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	7 0.0 -30.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		begin_block 10
			max_units		7
			unit_type		non_phalanx_spear 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; heavy and other infantry

		;; heavy infantry
		begin_block 11
			max_units			6
                        unit_type			heavy infantry 1.0
			unit_type			light infantry 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	10 0.0 -5.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; missile troops behind the spearmen and other infantry
		begin_block 12
			max_units			6
			unit_type			ranged_missile_infantry 0.9			
			unit_type			missile infantry	1.0
			unit_type			skirmish infantry	0.8
			default_melee_state	fire_at_will_and_defend
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	11 0.0 -5.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		begin_block 13
			max_units			6
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.9
			unit_type			chanting_screeching	0.5
			unit_type			skirmish infantry	0.8
			default_melee_state	fire_at_will_and_defend
			unit_density		close
			max_unit_width		40
			block_formation		line
			block_relative_pos	12 0.0 -5.0
			inter_unit_spacing	1.0
			priority			1.0
		end_block

		;; artillery and handler behind
		begin_block 14
			not_general
			unit_type					handler				1.0
			unit_type					siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -5.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		begin_block 15
			max_units			0
			not_general
			unit_type		any		1.0
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	14 0.0 -0.5
			inter_unit_spacing	0.3
			priority			1.0
		end_block

end_formation


begin_formation ai_mixed_missile_cavalry_attack 

	;;; purpose flags
	attack

	ai_priority			3.8

        supported_factions	parthia, numidia, carthage, pontus, armenia, egypt, seleucid

		; screen
		begin_block 0
			min_units			3
			max_units			3
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; light cav on either wing

		;; left side
		begin_block 1
			max_units			2
			not_general
			unit_type		elephants		1.0
			unit_type		heavy_chariots		1.0
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	0 -5.0 -5.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

		;; right side
		begin_block 2
			max_units			2
			not_general
			unit_type		elephants		1.0
			unit_type		heavy_chariots		1.0
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	0 5.0 -5.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

		;; Light cav reserves for either wing
		;; left side
		begin_block 3
			min_units			1
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 -30.0 -80.0
			inter_unit_spacing	3.0
			priority			0.3
		end_block

		;; right side
		begin_block 4
			min_units			1
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 30.0 -80.0
			inter_unit_spacing	3.0
			priority			0.3
		end_block

		;; cav behind centre
		begin_block 5
			not_general
			unit_type			cavalry 0.7
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -5.0 0.0
			inter_unit_spacing	3.0
			priority			0.1
		end_block

		begin_block 6
			not_general
			unit_type			cavalry 0.7
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	4 5.0 0.0
			inter_unit_spacing	3.0
			priority			0.1
		end_block

		;; Cavalry centre
		begin_block 7
			min_units			3
			max_units			6
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 0.8
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -50.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; general at the back
		begin_block 8
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -10.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block


		;; spearmen line
		begin_block 9
			max_units		7
			unit_type		phalanx 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	7 0.0 -30.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		begin_block 10
			max_units		7
			unit_type		non_phalanx_spear 1.0
			;default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; heavy and other infantry

		;; heavy infantry
		begin_block 11
			max_units			6
                        unit_type			heavy infantry 1.0
			unit_type			light infantry 1.0
			default_melee_state	engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	10 0.0 -5.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; missile troops behind the spearmen and other infantry
		begin_block 12
			max_units			6
			unit_type			ranged_missile_infantry 0.9			
			unit_type			missile infantry	1.0
			unit_type			skirmish infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	11 0.0 -5.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		begin_block 13
			max_units			6
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.9
			unit_type			chanting_screeching 0.5
			unit_type			skirmish infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			max_unit_width		40
			block_formation		line
			block_relative_pos	12 0.0 -5.0
			inter_unit_spacing	1.0
			priority			1.0
		end_block

		;; artillery and handler behind
		begin_block 14
			not_general
			unit_type					handler				1.0
			unit_type					siege				1.0
			default_melee_state	hold_fire_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -5.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		begin_block 15
			max_units			0
			not_general
			unit_type			any 1.0
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	14 0.0 -0.5
			inter_unit_spacing	0.3
			priority			1.0
		end_block

end_formation


;*******************************************************************************
; Formation for chariots and mixed missile cavalry armies - created by Sinuhet
;*******************************************************************************

begin_formation ai_chariots_defense 

	;;; purpose flags
	attack
	defend

	ai_priority			3.9

        supported_factions	britons, pontus, armenia, egypt, seleucid

		; screen
		begin_block 0
			min_units			3
			max_units			3
			not_general
			unit_type		heavy_chariots		1.0
			;default_melee_state	fire_at_will_and_defend_and skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; light cav on either wing

		;; left side
		begin_block 1
			max_units			2
			not_general
			unit_type		elephants		1.0
			unit_type		heavy_chariots		1.0
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	0 -5.0 -5.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

		;; right side
		begin_block 2
			max_units			2
			not_general
			unit_type		elephants		1.0
			unit_type		heavy_chariots		1.0
			;default_melee_state	fire_at_will_and_defend
			block_formation		column
			block_relative_pos	0 5.0 -5.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

		;; Light cav reserves for either wing
		;; left side
		begin_block 3
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 -30.0 -80.0
			inter_unit_spacing	3.0
			priority			0.3
		end_block

		;; right side
		begin_block 4
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 30.0 -80.0
			inter_unit_spacing	3.0
			priority			0.3
		end_block

		;; cav behind centre
		begin_block 5
			not_general
			unit_type			cavalry 0.7
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -5.0 0.0
			inter_unit_spacing	3.0
			priority			0.1
		end_block

		begin_block 6
			not_general
			unit_type			cavalry 0.7
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	4 5.0 0.0
			inter_unit_spacing	3.0
			priority			0.1
		end_block

		;; Cavalry centre
		begin_block 7
			min_units			1
			max_units			6
			not_general
			unit_type			heavy cavalry		1.0
			unit_type			light cavalry		0.8
			unit_type			heavy_chariots		0.01
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -50.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; general at the back
		begin_block 8
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -10.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block


		;; spearmen line
		begin_block 9
			max_units		7
			unit_type		phalanx 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	7 0.0 -30.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		begin_block 10
			max_units		7
			unit_type		non_phalanx_spear 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; heavy and other infantry

		;; heavy infantry
		begin_block 11
			max_units			6
                        unit_type			heavy infantry 1.0
			unit_type			light infantry 1.0
			;default_melee_state	defend
			unit_density		close
			block_formation		line
			block_relative_pos	10 0.0 -5.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; missile troops behind the spearmen and other infantry
		begin_block 12
			max_units			6
			unit_type			ranged_missile_infantry 0.9			
			unit_type			missile infantry	1.0
			unit_type			skirmish infantry	0.8
			default_melee_state	fire_at_will_and_defend
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	11 0.0 -5.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		begin_block 13
			max_units			6
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.9
			unit_type			chanting_screeching	0.5
			unit_type			skirmish infantry	0.8
			default_melee_state	fire_at_will_and_defend
			unit_density		close
			max_unit_width		40
			block_formation		line
			block_relative_pos	12 0.0 -5.0
			inter_unit_spacing	1.0
			priority			1.0
		end_block

		;; artillery and handler behind
		begin_block 14
			not_general
			unit_type					handler				1.0
			unit_type					siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -5.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		begin_block 15
			max_units			0
			not_general
			unit_type		any		1.0
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	14 0.0 -0.5
			inter_unit_spacing	0.3
			priority			1.0
		end_block

end_formation


begin_formation ai_chariots_attack 

	;;; purpose flags
	attack

	ai_priority			3.9

        supported_factions	britons, pontus, armenia, egypt, seleucid

		; screen
		begin_block 0
			min_units			3
			max_units			3
			not_general
			unit_type		heavy_chariots		1.0
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; light cav on either wing

		;; left side
		begin_block 1
			max_units			2
			not_general
			unit_type		elephants		1.0
			unit_type		heavy_chariots		1.0
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	0 -5.0 -5.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

		;; right side
		begin_block 2
			max_units			2
			not_general
			unit_type		elephants		1.0
			unit_type		heavy_chariots		1.0
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	0 5.0 -5.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

		;; Light cav reserves for either wing
		;; left side
		begin_block 3
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 -30.0 -80.0
			inter_unit_spacing	3.0
			priority			0.3
		end_block

		;; right side
		begin_block 4
			not_general
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 30.0 -80.0
			inter_unit_spacing	3.0
			priority			0.3
		end_block

		;; cav behind centre
		begin_block 5
			not_general
			unit_type			cavalry 0.7
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	3 -5.0 0.0
			inter_unit_spacing	3.0
			priority			0.1
		end_block

		begin_block 6
			not_general
			unit_type			cavalry 0.7
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	4 5.0 0.0
			inter_unit_spacing	3.0
			priority			0.1
		end_block

		;; Cavalry centre
		begin_block 7
			min_units			1
			max_units			6
			not_general
			unit_type			heavy cavalry		1.0
			unit_type			light cavalry		0.8
			unit_type			heavy_chariots		0.01
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -50.0
			inter_unit_spacing	2.0
			priority			0.5
		end_block

		;; general at the back
		begin_block 8
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -10.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block


		;; spearmen line
		begin_block 9
			max_units		7
			unit_type		phalanx 1.0
			default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	7 0.0 -30.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		begin_block 10
			max_units		7
			unit_type		non_phalanx_spear 1.0
			;default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 0.0 -5.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; heavy and other infantry

		;; heavy infantry
		begin_block 11
			max_units			6
                        unit_type			heavy infantry 1.0
			unit_type			light infantry 1.0
			default_melee_state	engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	10 0.0 -5.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

		;; missile troops behind the spearmen and other infantry
		begin_block 12
			max_units			6
			unit_type			ranged_missile_infantry 0.9			
			unit_type			missile infantry	1.0
			unit_type			skirmish infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
                        max_unit_width		40
			block_formation		line
			block_relative_pos	11 0.0 -5.0
			inter_unit_spacing	2.0
			priority			0.90
		end_block

		begin_block 13
			max_units			6
			unit_type			ranged_missile_infantry 1.0			
			unit_type			missile infantry	0.9
			unit_type			chanting_screeching 0.5
			unit_type			skirmish infantry	0.8
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			max_unit_width		40
			block_formation		line
			block_relative_pos	12 0.0 -5.0
			inter_unit_spacing	1.0
			priority			1.0
		end_block

		;; artillery and handler behind
		begin_block 14
			not_general
			unit_type					handler				1.0
			unit_type					siege				1.0
			default_melee_state	hold_fire_and_defend
			block_formation				line
			block_relative_pos			13 0.0 -5.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		begin_block 15
			max_units			0
			not_general
			unit_type			any 1.0
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	14 0.0 -0.5
			inter_unit_spacing	0.3
			priority			1.0
		end_block

end_formation


;****************************************************************
; Formation for generic missile cavalry armies - created by Sinuhet
;****************************************************************

begin_formation ai_generic_missile_cavalry_defend

	;;; purpose flags
	attack
	defend

	ai_priority			3.7

		; screen
		begin_block 0
			min_units			3
			max_units			3
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; light cav on either wing

		;; left side
		begin_block 1
			min_units			1
			max_units			2
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 -20.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; right side
		begin_block 2
			min_units			1
			max_units			2
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 20.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; Light cav reserves for either wing
		;; left side
		begin_block 3
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 -10.0 -40.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; right side
		begin_block 4
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 10.0 -40.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; cav behind centre
		begin_block 5
			unit_type			light cavalry 0.7
			unit_type			heavy cavalry 0.3
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 0.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		begin_block 6
			unit_type			light cavalry 0.7
			unit_type			heavy cavalry 0.3
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 0.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; Cavalry centre
		begin_block 7
			min_units			1
			max_units			6
			unit_type			light cavalry 0.3
			unit_type			heavy cavalry 0.7
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -10.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; general at the back
		begin_block 8
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_formation		square
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -10.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; artillery and handler behind
		begin_block 9
			unit_type					handler				1.0
			unit_type					siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			7 0.0 -50.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		begin_block 10
			max_units			0
			unit_type			any 0.1
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 0.0 -20.0
			inter_unit_spacing	0.3
			priority			0.5
		end_block

end_formation


begin_formation ai_generic_missile_cavalry_attack

	;;; purpose flags
	attack

	ai_priority			3.7

		; screen
		begin_block 0
			min_units			3
			max_units			3
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; light cav on either wing

		;; left side
		begin_block 1
			min_units			1
			max_units			2
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 -20.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; right side
		begin_block 2
			min_units			1
			max_units			2
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 20.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; Light cav reserves for either wing
		;; left side
		begin_block 3
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 -10.0 -40.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; right side
		begin_block 4
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 10.0 -40.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; cav behind centre
		begin_block 5
			unit_type			light cavalry 0.7
			unit_type			heavy cavalry 0.3
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 0.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		begin_block 6
			unit_type			light cavalry 0.7
			unit_type			heavy cavalry 0.3
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	2 0.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; Cavalry centre
		begin_block 7
			min_units			1
			max_units			6
			unit_type			light cavalry 0.3
			unit_type			heavy cavalry 0.7
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -10.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; general at the back
		begin_block 8
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density			close
			block_formation			line
			block_relative_pos		7 0.0 -10.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; artillery and handler behind
		begin_block 9
			unit_type					handler				1.0
			unit_type					siege				1.0
			default_melee_state	hold_fire_and_defend
			block_formation				line
			block_relative_pos			7 0.0 -50.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		begin_block 10
			max_units			0
			unit_type			any 0.1
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 0.0 -20.0
			inter_unit_spacing	0.3
			priority			0.5
		end_block

end_formation


;****************************************************************
; Formation for cavalry armies - created by Sinuhet
;****************************************************************

begin_formation ai_cavalry_defend

	;;; purpose flags
	attack
	defend

	ai_priority			3.7


		;; Cavalry centre
		begin_block 0
			min_units			1
			max_units			6
			unit_type			heavy cavalry 1.0
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		; screen
		begin_block 1
			max_units			4
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 50.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block


		;; light cav on either wing

		;; left side
		begin_block 2
			max_units			2
			unit_type			light cavalry 1.0
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 -20.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; right side
		begin_block 3
			max_units			2
			unit_type			light cavalry 1.0
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 20.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; general at the back
		begin_block 4
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend
			unit_formation		square
			unit_density			close
			block_formation			line
			block_relative_pos		0 0.0 -10.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; heavy cav behind centre
		begin_block 5
			unit_type			heavy cavalry 1.0
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	4 -10.0 0.0
			inter_unit_spacing	4.0
			priority			0.2
		end_block

		begin_block 6
			unit_type			heavy cavalry 1.0
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	4 10.0 0.0
			inter_unit_spacing	4.0
			priority			0.2
		end_block

		;; Light cav reserves for either wing
		;; left side
		begin_block 7
			unit_type			light cavalry 1.0
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 -10.0 -20.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; right side
		begin_block 8
			unit_type			light cavalry 1.0
			;default_melee_state	defend
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 10.0 -20.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; artillery and handler behind
		begin_block 9
			unit_type					handler				1.0
			unit_type					siege				1.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			0 0.0 -50.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		begin_block 10
			max_units			0
			unit_type			any 0.1
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 0.0 -20.0
			inter_unit_spacing	0.3
			priority			0.5
		end_block

end_formation


begin_formation ai_cavalry_attack

	;;; purpose flags
	attack

	ai_priority			3.7


		;; Cavalry centre
		begin_block 0
			min_units			1
			max_units			6
			unit_type			heavy cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		; screen
		begin_block 1
			max_units			4
			unit_type			missile cavalry 1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 50.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block


		;; light cav on either wing

		;; left side
		begin_block 2
			max_units			2
			unit_type			light cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 -20.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; right side
		begin_block 3
			max_units			2
			unit_type			light cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	1 20.0 0.0
			inter_unit_spacing	4.0
			priority			1.0
		end_block

		;; general at the back
		begin_block 4
			max_units				1
			unit_type				general_unit			1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_formation		square
			unit_density			close
			block_formation			line
			block_relative_pos		0 0.0 -10.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; heavy cav behind centre
		begin_block 5
			unit_type			heavy cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	4 -10.0 0.0
			inter_unit_spacing	4.0
			priority			0.2
		end_block

		begin_block 6
			unit_type			heavy cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	4 10.0 0.0
			inter_unit_spacing	4.0
			priority			0.2
		end_block

		;; Light cav reserves for either wing
		;; left side
		begin_block 7
			unit_type			light cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 -10.0 -20.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; right side
		begin_block 8
			unit_type			light cavalry 1.0
			default_melee_state	engage_at_will
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 10.0 -20.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; artillery and handler behind
		begin_block 9
			unit_type					handler				1.0
			unit_type					siege				1.0
			default_melee_state	hold_fire_and_defend
			block_formation				line
			block_relative_pos			0 0.0 -50.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

		begin_block 10
			max_units			0
			unit_type			any 0.1
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	9 0.0 -20.0
			inter_unit_spacing	0.3
			priority			0.5
		end_block

end_formation


;****************************************************************
;****************************************************************
; Standard formation and other modified formations section
;****************************************************************
;****************************************************************

;****************************************************************
;Standard formation. Infantry line in front, missiles behind
;cav on the wings (modified by Sinuhet)
;****************************************************************

begin_formation ai_standard_line_2a

	;;; purpose flags
	attack
	defend

	;;; decreased AI priority - Sinuhet
	ai_priority			1.9

		begin_block 0
			min_units			1
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			unit_type			phalanx 0.1
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 1
			unit_type			non_phalanx_spear 0.8
			unit_type			heavy infantry 0.7
			block_formation		line
			block_relative_pos	0 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.5
		end_block

		;; right side
		begin_block 2
			unit_type			non_phalanx_spear 0.8
			unit_type			heavy infantry 0.7
			block_formation		line
			block_relative_pos	0 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.5
		end_block

		;; missile troops behind the centre
		begin_block 3
			unit_type			missile infantry	0.5
			unit_type			skirmish infantry	0.5
			unit_type			chanting_screeching 0.5
			unit_type			light infantry		0.3
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.4
		end_block

		begin_dummy_block 4
			spans 0 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 5
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 -10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 6
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 10.0 -30.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 7
			not_general
			unit_type			missile cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 8
			not_general
			unit_type			missile cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 9
			max_units				1
			unit_type				general_unit			1.0
                        default_melee_state		defend
			unit_density			close
			block_formation			line
			block_relative_pos		0 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 10
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			0 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 11
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			10 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


begin_formation ai_standard_line_2b

	;;; purpose flags
	attack

	;;; decreased AI priority - Sinuhet
	ai_priority			1.9

		begin_block 0
			min_units			1
			unit_type			heavy infantry 0.9
			unit_type			light infantry 0.8
			unit_type			phalanx 0.1
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	0.3
			priority			1.0
		end_block

		;; heavy and light infantry either side of the spearmen

		;; left side
		begin_block 1
			unit_type			non_phalanx_spear 0.8
			unit_type			heavy infantry 0.7
			block_formation		line
			block_relative_pos	0 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.5
		end_block

		;; right side
		begin_block 2
			unit_type			non_phalanx_spear 0.8
			unit_type			heavy infantry 0.7
			block_formation		line
			block_relative_pos	0 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.5
		end_block

		;; missile troops behind the centre
		begin_block 3
			unit_type			missile infantry	0.5
			unit_type			skirmish infantry	0.5
			unit_type			chanting_screeching 0.5
			unit_type			light infantry		0.3
                        max_unit_width		40
			block_formation		line
			block_relative_pos	0 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.4
		end_block

		begin_dummy_block 4
			spans 0 1 2
		end_dummy_block

		;; cavalry on the flanks and back a bit

		;; left flank
		begin_block 5
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	4 -20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; right_flank
		begin_block 6
			not_general
			unit_type			heavy cavalry 1.0
			unit_type			light cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	4 20.0 -40.0
			inter_unit_spacing	4.0
			priority			0.5
		end_block

		;; left flank missile cav
		begin_block 7
			not_general
			unit_type			missile cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	5 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; right_flank missile cav
		begin_block 8
			not_general
			unit_type			missile cavalry 1.0
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	6 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.6
		end_block

		;; general at the back
		begin_block 9
			max_units				1
			unit_type				general_unit			1.0
                        default_melee_state		defend
			unit_density			close
			block_formation			line
			block_relative_pos		4 0.0 -30.0
			inter_unit_spacing		3.0
			priority				1.0
		end_block

		;; any behind
		begin_block 10
			unit_type			any					0.5
			block_formation				line
			block_relative_pos			4 0.0 -50.0
			inter_unit_spacing			0.3
			priority					0.1
		end_block

		;; artillery and handler behind
		begin_block 11
			unit_type			handler				1.0
			unit_type			siege				1.0
			block_formation				line
			block_relative_pos			10 0.0 -20.0
			inter_unit_spacing			3.0
			priority					0.1
		end_block

end_formation


;****************************************************************
;****************************************************************
; Small formations section
;****************************************************************
;****************************************************************


;****************************************************************
;The special small formation for light cavalry pursuing
;****************************************************************


begin_formation	ai_small_light_cavalry_in_pursue_1

	;;; purpose flags
	pursue

	ai_priority			4.1

	supported_factions	gauls, germans, dacia, scythia, alemanni, spain, numidia, carthage, pontus, armenia, egypt, macedon, seleucid

		begin_block 0
			min_units			1
			max_units			2
			not_general
			unit_type			light cavalry 2.0
			default_melee_state	engage_at_will
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.1
		end_block

	begin_block 1
		max_units			0
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_light_cavalry_in_pursue_2

	;;; purpose flags
	pursue

	ai_priority			4.1

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			light cavalry 2.0
			default_melee_state	engage_at_will
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.1
		end_block

	begin_block 1
		max_units			0
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation



;****************************************************************
;The special small formation for missile cavalry pursuing
;****************************************************************


begin_formation	ai_small_missile_cavalry_in_pursue_1

	;;; purpose flags
	pursue

	ai_priority			1.0

	supported_factions	gauls, germans, dacia, scythia, alemanni, spain, numidia, carthage, pontus, armenia, egypt, macedon, seleucid

		begin_block 0
			min_units			1
			max_units			2
			not_general
			unit_type			missile cavalry	0.6
			default_melee_state	fire_at_will_and_skirmish
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_missile_cavalry_in_pursue_2

	;;; purpose flags
	pursue

	ai_priority			1.0

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			missile cavalry	0.6
			default_melee_state	fire_at_will_and_skirmish
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


;****************************************************************
;The special small formation for cavalry pursuing
;****************************************************************


begin_formation	ai_small_cavalry_in_pursue_1

	;;; purpose flags
	pursue

	ai_priority			0.98

	supported_factions	gauls, germans, dacia, scythia, alemanni, spain, numidia, carthage, pontus, armenia, egypt, macedon, seleucid

		begin_block 0
			min_units			1
			max_units			2
			not_general
			unit_type			light cavalry 1.0
			unit_type			heavy cavalry 0.1
			default_melee_state	engage_at_will
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_cavalry_in_pursue_2

	;;; purpose flags
	pursue

	ai_priority			0.98

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			light cavalry 1.0
			unit_type			heavy cavalry 0.1
			default_melee_state	engage_at_will
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


;****************************************************************
;The special small formation for missile infantry pursuing
;****************************************************************


begin_formation	ai_small_missile_infantry_in_pursue_1

	;;; purpose flags
	pursue

	ai_priority			0.96

	supported_factions	britons, gauls, germans, dacia, scythia, alemanni, spain, numidia, carthage, pontus, armenia, thrace

		begin_block 0
			min_units			1
			max_units			2
			not_general
			unit_type			missile infantry	1.0
			default_melee_state	fire_at_will_and_skirmish
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_missile_infantry_in_pursue_2

	;;; purpose flags
	pursue

	ai_priority			0.96

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			missile infantry	1.0
			default_melee_state	fire_at_will_and_skirmish
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


;****************************************************************
;The special small formation for infantry pursuing
;****************************************************************


begin_formation	ai_small_infantry_in_pursue_1

	;;; purpose flags
	pursue

	ai_priority			0.95

	supported_factions	britons, gauls, germans, dacia, spain, thrace

		begin_block 0
			min_units			2
			max_units			2
			not_general
			unit_type			light infantry		0.1
			unit_type			heavy infantry		0.0
			unit_type			spearmen infantry	0.0
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_infantry_in_pursue_2

	;;; purpose flags
	pursue

	ai_priority			0.95

	supported_factions	britons, gauls, germans, dacia, scythia, alemanni, spain, numidia, carthage, pontus, armenia, thrace

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			light infantry		0.1
			unit_type			heavy infantry		0.0
			unit_type			spearmen infantry	0.0
			default_melee_state	fire_at_will_and_engage_at_will
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			0.5
		end_block

	begin_block 1
		max_units			0
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


;****************************************************************
;The special small formation for elephants attacks
;****************************************************************


begin_formation	ai_small_elephants_in_attack

	;;; purpose flags
	attack

	ai_priority			1.0

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			elephants	1.0
			default_melee_state	fire_at_will_and_engage_at_will 
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_elephants_in_defense

	;;; purpose flags
	defend

	ai_priority			1.0

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			elephants	1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish 
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation

;****************************************************************
;The special small formation for heavy chariots
;****************************************************************


begin_formation	ai_small_heavy_chariots_in_attack_1

	;;; purpose flags
	attack

	ai_priority			1.0

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			heavy_chariots	1.0
			default_melee_state	fire_at_will_and_engage_at_will 
			unit_density		close
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_heavy_chariots_in_defense_1

	;;; purpose flags
	defend

	ai_priority			1.0

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			heavy_chariots	1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_heavy_chariots_in_attack_2

	;;; purpose flags
	attack

	ai_priority			1.0

	supported_factions	britons, pontus, armenia, egypt, seleucid, slave

		begin_block 0
			min_units			1
			max_units			2
			not_general
			unit_type			heavy_chariots	1.0
			default_melee_state	fire_at_will_and_engage_at_will 
			unit_density		close
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_heavy_chariots_in_defense_2

	;;; purpose flags
	defend

	ai_priority			1.0

	supported_factions	britons, pontus, armenia, egypt, seleucid, slave

		begin_block 0
			min_units			1
			max_units			2
			not_general
			unit_type			heavy_chariots	1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation

;****************************************************************
;The special small formation for missile cavalry attacks
;****************************************************************


begin_formation	ai_small_missile_cavalry_in_attack_1

	;;; purpose flags
	attack

	ai_priority			1.0

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			missile cavalry	1.0
			default_melee_state	fire_at_will
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_missile_cavalry_in_defense_1

	;;; purpose flags
	defend

	ai_priority			1.0

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			missile cavalry	1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish 
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_missile_cavalry_in_attack_2a

	;;; purpose flags
	attack

	ai_priority			1.0

	supported_factions	scythia, alemanni

		begin_block 0
			min_units			1
			max_units			3
			not_general
			unit_type			missile cavalry	1.0
			default_melee_state	fire_at_will
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_missile_cavalry_in_defense_2a

	;;; purpose flags
	defend

	ai_priority			1.0

	supported_factions	scythia, alemanni

		begin_block 0
			min_units			1
			max_units			3
			not_general
			unit_type			missile cavalry	1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish 
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_missile_cavalry_in_attack_2b

	;;; purpose flags
	attack

	ai_priority			1.0

	supported_factions	scythia, alemanni, numidia, pontus, armenia

		begin_block 0
			min_units			1
			max_units			2
			not_general
			unit_type			missile cavalry	1.0
			default_melee_state	fire_at_will
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_missile_cavalry_in_defense_2b

	;;; purpose flags
	defend

	ai_priority			1.0

	supported_factions	scythia, alemanni, numidia, pontus, armenia

		begin_block 0
			min_units			1
			max_units			2
			not_general
			unit_type			missile cavalry	1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish 
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


;****************************************************************
;The special small formation for heavy and light cavalry attacks
;****************************************************************


begin_formation	ai_small_heavy_cavalry_in_attack_1

	;;; purpose flags
	attack

	ai_priority			4.0

	supported_factions	macedon

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			heavy cavalry	1.0
			default_melee_state	engage_at_will 
			unit_formation		wedge
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

		begin_block 1
			min_units			2
			max_units			2
			not_general
			unit_type			heavy cavalry	1.0
			default_melee_state	engage_at_will 
			unit_formation		wedge
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -5.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

		begin_block 2
			min_units			1
			max_units			2
			not_general
			unit_type			heavy cavalry	1.0
			unit_type			light cavalry 0.1
			default_melee_state	engage_at_will 
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -5.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block


	begin_block 3
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			2 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_heavy_cavalry_in_attack_2

	;;; purpose flags
	attack
	defend

	ai_priority			1.0

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			heavy cavalry	1.0
			default_melee_state	engage_at_will 
			unit_density		close
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_heavy_cavalry_in_attack_3a

	;;; purpose flags
	attack
	defend

	ai_priority			1.0

	supported_factions	gauls, germans, dacia, scythia, alemanni, spain, carthage, parthia, pontus, armenia, egypt, macedon, seleucid

		begin_block 0
			min_units			1
			max_units			2
			not_general
			unit_type			heavy cavalry	1.0
			unit_type			light cavalry 0.1
			default_melee_state	engage_at_will 
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_heavy_cavalry_in_attack_3b

	;;; purpose flags
	attack
	defend

	ai_priority			1.0

	supported_factions	romans_julii, romans_brutii, romans_scipii, romans_senate

		begin_block 0
			min_units			1
			max_units			2
			not_general
			unit_type			heavy cavalry	1.0
			default_melee_state	engage_at_will 
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_heavy_cavalry_in_attack_4

	;;; purpose flags
	attack
	defend

	ai_priority			1.0

	supported_factions	carthage, parthia, macedon

		begin_block 0
			min_units			1
			max_units			3
			not_general
			unit_type			heavy cavalry	1.0
			unit_type			light cavalry 0.1
			default_melee_state	engage_at_will 
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


;****************************************************************
;The special small formation for light only cavalry attacks
;****************************************************************


begin_formation	ai_small_light_cavalry_in_attack_1

	;;; purpose flags
	attack
	defend

	ai_priority			0.95

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			light cavalry	1.0
			default_melee_state	engage_at_will 
			unit_density		close
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_light_cavalry_in_attack_2

	;;; purpose flags
	attack
	defend

	ai_priority			0.95

	supported_factions	gauls, germans, dacia, scythia, alemanni, spain, carthage, parthia, pontus, armenia, egypt, macedon, seleucid

		begin_block 0
			min_units			1
			max_units			2
			not_general
			unit_type			light cavalry	1.0
			default_melee_state	engage_at_will 
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_light_cavalry_in_attack_3

	;;; purpose flags
	attack
	defend

	ai_priority			0.95

	supported_factions	carthage, parthia, macedon

		begin_block 0
			min_units			1
			max_units			3
			not_general
			unit_type			light cavalry	1.0
			default_melee_state	engage_at_will 
			unit_formation		square
			unit_density		close
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


;****************************************************************
;The special small formation for skirmishers
;****************************************************************


begin_formation	ai_small_skirmishers_in_attack_1

	;;; purpose flags
	attack

	ai_priority			1.0

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			skirmish infantry	1.0
			;unit_type			missile infantry	0.1
			default_melee_state	fire_at_will
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_skirmishers_in_defense_1

	;;; purpose flags
	defend

	ai_priority			1.0

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			skirmish infantry	1.0
			;unit_type			missile infantry	0.1
			default_melee_state	fire_at_will_and_defend_and_skirmish
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_skirmishers_in_attack_2

	;;; purpose flags
	attack

	ai_priority			1.0

	supported_factions	britons, gauls, germans, dacia, scythia, alemanni, spain, numidia, carthage, pontus, armenia, thrace

		begin_block 0
			min_units			1
			max_units			2
			not_general
			unit_type			skirmish infantry	1.0
			;unit_type			missile infantry	0.1
			default_melee_state	fire_at_will
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_skirmishers_in_defense_2

	;;; purpose flags
	defend

	ai_priority			1.0

	supported_factions	britons, gauls, germans, dacia, scythia, alemanni, spain, numidia, carthage, pontus, armenia, thrace

		begin_block 0
			min_units			1
			max_units			2
			not_general
			unit_type			skirmish infantry	1.0
			;unit_type			missile infantry	0.1
			default_melee_state	fire_at_will_and_defend_and_skirmish
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


;****************************************************************
;The special small formation for ranged-missiles
;****************************************************************


begin_formation	ai_small_ranged-missiles_in_attack_1

	;;; purpose flags
	attack

	ai_priority			1.0

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			ranged_missile_infantry	1.0
			unit_type			missile infantry	0.1
			default_melee_state	fire_at_will_and_skirmish
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_ranged-missiles_in_defense_1

	;;; purpose flags
	defend

	ai_priority			1.0

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			ranged_missile_infantry	1.0
			unit_type			missile infantry	0.1
			default_melee_state	fire_at_will_and_defend_and_skirmish
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_ranged-missiles_in_attack_2

	;;; purpose flags
	attack

	ai_priority			1.0

	supported_factions	britons, gauls, germans, dacia, scythia, alemanni, spain, numidia, carthage, pontus, armenia, thrace

		begin_block 0
			min_units			1
			max_units			2
			not_general
			unit_type			ranged_missile_infantry	1.0
			unit_type			missile infantry	0.1
			default_melee_state	fire_at_will_and_skirmish
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_ranged-missiles_in_defense_2

	;;; purpose flags
	defend

	ai_priority			1.0

	supported_factions	britons, gauls, germans, dacia, scythia, alemanni, spain, numidia, carthage, pontus, armenia, thrace

		begin_block 0
			min_units			1
			max_units			2
			not_general
			unit_type			ranged_missile_infantry	1.0
			unit_type			missile infantry	0.1
			default_melee_state	fire_at_will_and_defend_and_skirmish
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


;****************************************************************
;The special small formation for phalanges
;****************************************************************


begin_formation	ai_small_phalanx_in_attack_1a

	;;; purpose flags
	attack

	ai_priority			1.0

	supported_factions	carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		begin_block 0
			min_units			4
			max_units			6
			not_general
			unit_type			phalanx	1.0
			;default_melee_state	defend
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_phalanx_in_defense_1a

	;;; purpose flags
	defend

	ai_priority			1.0

	supported_factions	carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		begin_block 0
			min_units			4
			max_units			6
			not_general
			unit_type			phalanx	1.0
			default_melee_state	defend
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_phalanx_in_attack_1b

	;;; purpose flags
	attack

	ai_priority			1.0

		begin_block 0
			min_units			3
			max_units			3
			not_general
			unit_type			phalanx	1.0
			;default_melee_state	defend
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_phalanx_in_defense_1b

	;;; purpose flags
	defend

	ai_priority			1.0

		begin_block 0
			min_units			3
			max_units			3
			not_general
			unit_type			phalanx	1.0
			default_melee_state	defend
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_phalanx_in_attack_2

	;;; purpose flags
	attack

	ai_priority			1.0

		begin_block 0
			min_units			2
			max_units			2
			not_general
			unit_type			phalanx	1.0
			;default_melee_state	defend
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_phalanx_in_defense_2

	;;; purpose flags
	defend

	ai_priority			1.0

		begin_block 0
			min_units			2
			max_units			2
			not_general
			unit_type			phalanx	1.0
			default_melee_state	defend
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


;****************************************************************
;The special small formation for non_phalanx_spear
;****************************************************************


begin_formation	ai_small_non_phalanx_spear_in_attack_1a

	;;; purpose flags
	attack
	pursue

	ai_priority			1.0

	supported_factions	carthage, numidia, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		begin_block 0
			min_units			3
			max_units			6
			not_general
			unit_type			non_phalanx_spear	1.0
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_non_phalanx_spear_in_defense_1a

	;;; purpose flags
	defend

	ai_priority			1.0

	supported_factions	carthage, numidia, pontus, armenia, egypt, macedon, seleucid, greek_cities, thrace

		begin_block 0
			min_units			3
			max_units			6
			not_general
			unit_type			non_phalanx_spear	1.0
			;default_melee_state	defend
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_non_phalanx_spear_in_attack_1b

	;;; purpose flags
	attack
	pursue

	ai_priority			1.0

	supported_factions	britons, gauls, germans, dacia, scythia, alemanni, spain, slave, romans_julii, romans_brutii, romans_scipii, romans_senate

		begin_block 0
			min_units			3
			max_units			6
			not_general
			unit_type			non_phalanx_spear	1.0
			;default_melee_state	engage_at_will
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_non_phalanx_spear_in_defense_1b

	;;; purpose flags
	defend

	ai_priority			1.0

	supported_factions	britons, gauls, germans, dacia, scythia, alemanni, spain, slave, romans_julii, romans_brutii, romans_scipii, romans_senate

		begin_block 0
			min_units			3
			max_units			6
			not_general
			unit_type			non_phalanx_spear	1.0
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_non_phalanx_spear_in_attack_2

	;;; purpose flags
	attack

	ai_priority			1.0

		begin_block 0
			min_units			2
			max_units			2
			not_general
			unit_type			non_phalanx_spear	1.0
			;default_melee_state	engage_at_will
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_non_phalanx_spear_in_defense_2

	;;; purpose flags
	defend

	ai_priority			1.0

		begin_block 0
			min_units			2
			max_units			2
			not_general
			unit_type			non_phalanx_spear	1.0
			;default_melee_state	defend
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation

;****************************************************************
;The special small formation for non-spear infantry
;****************************************************************


begin_formation	ai_small_infantry_in_attack_1a

	;;; purpose flags
	attack
	pursue

	ai_priority			1.0

	supported_factions	romans_julii, romans_brutii, romans_scipii, romans_senate

		begin_block 0
			min_units			2
			max_units			5
			not_general
			unit_type			heavy_pilum_infantry 1.0
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	20.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_infantry_in_attack_1b

	;;; purpose flags
	attack
	pursue

	ai_priority			1.0

	supported_factions	romans_julii, romans_brutii, romans_scipii, romans_senate

		begin_block 0
			min_units			2
			max_units			5
			not_general
			unit_type			light infantry 1.0
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	10.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_infantry_in_attack_2

	;;; purpose flags
	attack

	ai_priority			1.0

	supported_factions	britons, gauls, germans, dacia, scythia, alemanni, spain, thrace

		begin_block 0
			min_units			1
			max_units			2
			not_general
			unit_type			heavy infantry	1.0
			unit_type			light infantry	0.5
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		column
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_infantry_in_attack_3

	;;; purpose flags
	attack

	ai_priority			1.0

	supported_factions	numidia, slave, carthage, pontus, armenia, egypt, macedon, seleucid, greek_cities

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			heavy infantry	1.0
			unit_type			light infantry	1.0
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_infantry_in_defense

	;;; purpose flags
	defend

	ai_priority			1.0

	supported_factions	britons, gauls, germans, dacia, scythia, alemanni, spain, thrace

		begin_block 0
			min_units			1
			max_units			1
			not_general
			unit_type			heavy infantry	1.0
			unit_type			light infantry	1.0
			default_melee_state	fire_at_will_and_engage_at_will
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


;****************************************************************
;The special small formation for alone general unit
;****************************************************************


begin_formation	ai_small_general_defend

	;;; purpose flags
	defend

	ai_priority			1.0

		begin_block 0
			min_units			1
			max_units			1
			unit_type			general_unit	1.0
			default_melee_state	fire_at_will_and_defend_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		not_general
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


begin_formation	ai_small_general_attack

	;;; purpose flags
	attack

	ai_priority			1.0

		begin_block 0
			min_units			1
			max_units			1
			unit_type			general_unit	1.0
			default_melee_state	fire_at_will_and_skirmish
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	2.0
			priority			1.0
		end_block

	begin_block 1
		max_units			0
		unit_type				any		0.1
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					0.5
	end_block	

end_formation


;****************************************************************
;****************************************************************
; Unmodified formations section
;****************************************************************
;****************************************************************

;****************************************************************
;The simplest formation. The units are lined up in a single line
;****************************************************************


begin_formation	ai_line

	;;; purpose flags
	attack													; can use this for anything
	defend

	ai_priority			0.3

		begin_block 0
			min_units			1
			unit_type			any 1.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0
			inter_unit_spacing	3.0
			priority			1.0
		end_block

	;; put the artillery and handlers behind everyone

	begin_block 1
		unit_type					handler				1.0
		unit_type					siege				1.0
		block_formation				line
		block_relative_pos			0 0.0 -5.0
		inter_unit_spacing			3.0
		priority					1.0
	end_block	

end_formation




;****************************************************************
; a single line, but with the units ordered with heavy infantry in the centre
; lighter infantry on the flanks, and cavalry on the wings
;****************************************************************


begin_formation ai_ordered_single_line

	;;; purpose flags
	attack													; can use this for anything
	defend
	
	ai_priority			0.5

		;; centre block
		begin_block 0
			min_units			1
			unit_type			heavy infantry		1.0
			unit_type			light infantry		0.8
			unit_type			infantry			0.1
			unit_type			any					0.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 0.0 
			inter_unit_spacing	3.0
			priority			1.0
		end_block

		;; right of centre
		begin_block 1
			unit_type			missile infantry	1.0
			unit_type			light infantry		1.0
			unit_type			skirmish infantry	1.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 3.0 0.0 
			inter_unit_spacing	3.0
			priority			0.9
		end_block

		;; right wing
		begin_block 2
			unit_type			cavalry				1.0
			unit_density		close
			block_formation		line
			block_relative_pos	1 3.0 0.0 
			inter_unit_spacing	3.0
			priority			0.9
		end_block

		;; left of centre
		begin_block 3
			unit_type			missile infantry	1.0
			unit_type			light infantry		1.0
			unit_type			skirmish infantry	1.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 -3.0 0.0 
			inter_unit_spacing	3.0
			priority			0.9
		end_block

		;; left wing
		begin_block 4
			unit_type			cavalry				1.0
			unit_density		close
			block_formation		line
			block_relative_pos	3 -3.0 0.0 
			inter_unit_spacing	3.0
			priority			0.9
		end_block

		;; put the artillery and handlers behind everyone
		begin_dummy_block 5
			spans 0 1 2 3 4
		end_dummy_block

		begin_block 6
			unit_type					handler				1.0
			unit_type					siege				1.0
			block_formation				line
			block_relative_pos			6 0.0 -5.0
			inter_unit_spacing			3.0
			priority					1.0
		end_block	

end_formation




begin_formation ai_simple_double_line

	;;; purpose flags
	attack
	defend
	ai_priority		0.4

	;;; front
	begin_block 0
		min_units				1
		unit_type				any					1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;;; rear
	begin_block 1
		min_units				1
		unit_type				any					1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -3.0
		inter_unit_spacing		3.0
		priority				0.8
	end_block

	;; put the artillery and handlers behind everyone
	begin_block 2
		unit_type					handler				1.0
		unit_type					siege				1.0
		block_formation				line
		block_relative_pos			1 0.0 -5.0
		inter_unit_spacing			3.0
		priority					1.0
	end_block
	
	;;; special general block
	begin_block 3
		min_units				1
		max_units				1
		unit_type				general_unit			1.0
		unit_density			close
		block_formation			line
		block_relative_pos		2 0.0 -3.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

end_formation




;****************************************************************
; Double Line. Missile troops in front, anything else behind
;****************************************************************


begin_formation ai_double_missiles_in_front

	;;; purpose flags
	defend
	ai_priority		0.6

	;;; The missile units
	begin_block 0
		min_units				1
		unit_type				missile					1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;;; Centre slot of rear row
	begin_block 1
		unit_type				heavy infantry			1.0
		unit_type				light infantry			1.0
		unit_type				skirmish infantry		1.0
		unit_type				spearmen infantry		1.0
		unit_type				heavy cavalry			0.0
		unit_type				light cavalry			0.0
		unit_type				skirmish cavalry		0.0
		unit_type				spearmen cavalry		0.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -3.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;;; Right slot of rear row
	begin_block 2
		unit_type				heavy cavalry			1.0
		unit_type				light cavalry			1.0
		unit_type				skirmish cavalry		1.0
		unit_type				spearmen cavalry		1.0
		unit_density			close
		block_formation			line
		block_relative_pos		1 3.0 0.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;;; left slot of rear row
	begin_block 3
		unit_type				heavy cavalry			1.0
		unit_type				light cavalry			1.0
		unit_type				skirmish cavalry		1.0
		unit_type				spearmen cavalry		1.0
		unit_density			close
		block_formation			line
		block_relative_pos		1 -3.0 0.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 4
		spans					0 1 2 3
	end_dummy_block

	begin_block 5
		unit_type					handler				1.0
		unit_type					siege				1.0
		block_formation				line
		block_relative_pos			4 0.0 -5.0
		inter_unit_spacing			3.0
		priority					1.0
	end_block

	begin_dummy_block 6
		spans					0 1 2 3 4 5
	end_dummy_block		

	;;; special general block
	begin_block 7
		min_units				1
		max_units				1
		unit_type				general_unit			1.0
		unit_density			close
		block_formation			line
		block_relative_pos		6 0 -3.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 8
		spans 0 1 2 3 4 5 6 7
	end_dummy_block

	begin_block 9
		unit_type					handler				1.0
		unit_type					siege				1.0
		block_formation				line
		block_relative_pos			8 0.0 -5.0
		inter_unit_spacing			3.0
		priority					1.0
	end_block	

end_formation




;****************************************************************
; Double Line. Spearmen and heavy infantry in front, 
; anything else behind
;****************************************************************


begin_formation ai_double_heavy_infantry_in_front

	;;; purpose flags
	attack
	defend
	ai_priority		0.6

	;;; heavy units
	begin_block 0
		min_units				1
		unit_type				heavy infantry		1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;;; Centre slot of rear row
	begin_block 1
		unit_type				infantry			1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -3.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;;; Right slot of rear row
	begin_block 2
		unit_type				cavalry				0.6
		unit_density			close
		block_formation			line
		block_relative_pos		1 3.0 0.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;;; left slot of rear row
	begin_block 3
		unit_type				cavalry			1.0
		unit_density			close
		block_formation			line
		block_relative_pos		1 -3.0 0.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 4
		spans 0 1 2 3
	end_dummy_block

	begin_block 5
		unit_type					handler				1.0
		unit_type					siege				1.0
		block_formation				line
		block_relative_pos			4 0.0 -5.0
		inter_unit_spacing			3.0
		priority					1.0
	end_block
		
	begin_dummy_block 6
		spans					0 1 2 3 4 5
	end_dummy_block

	;;; special general block
	begin_block 7
		min_units				1
		max_units				1
		unit_type				general_unit			1.0
		unit_density			close
		block_formation			line
		block_relative_pos		6 0 -3.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

end_formation




;****************************************************************
; Double Line. Spearmen and heavy infantry in front, 
; anything else behind. Single unit screen in front
;****************************************************************


begin_formation ai_double_assault_infantry_in_front

	;;; purpose flags
	attack
	ai_priority		0.6

	;;; The screen
	begin_block 0
		max_units				1
		unit_type				missile infantry	1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;;; The assault units
	begin_block 1
		min_units				1
		unit_type				light infantry		1.0
		unit_type				heavy infantry		0.3
		unit_type				heavy cavalry		0.1
		unit_type				light cavalry		0.1
		unit_type				skirmish cavalry	0.1
		unit_type				spearmen cavalry	0.1
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -3.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;;; A heavy unit on the end of the line
	begin_block 2
		max_units				1
		unit_type				heavy infantry		1.0
		unit_density			close
		block_formation			line
		block_relative_pos		1 2.0 0.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;;; A heavy unit on the end of the line
	begin_block 3
		max_units				1
		unit_type				heavy infantry		1.0
		unit_density			close
		block_formation			line
		block_relative_pos		1 -2.0 0.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	begin_dummy_block 4
		spans					0 1 2 3
	end_dummy_block

	;;; centre slot of rear row
	begin_block 5
		unit_type				missile				1.0
		unit_type				infantry			0.5
		unit_type				any					0.3
		unit_density			close
		block_formation			line
		block_relative_pos		4 0.0 -5.0
		inter_unit_spacing		3.0
		priority				0.6
	end_block

	;;; right slot of rear row
	begin_block 6
		unit_type				cavalry				1.0
		unit_density			close
		block_formation			line
		block_relative_pos		5 3.0 0.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;;; left slot of rear row
	begin_block 7
		unit_type				cavalry				1.0
		unit_density			close
		block_formation			line
		block_relative_pos		5 -3.0 0.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;; put the artillery and handlers behind everyone
	begin_dummy_block 8
		spans 0 1 2 3 4 5 6 7
	end_dummy_block

	begin_block 9
		unit_type					handler				1.0
		unit_type					siege				1.0
		block_formation				line
		block_relative_pos			8 0.0 -5.0
		inter_unit_spacing			3.0
		priority					1.0
	end_block

	;;; dummy slot spanning second line
	begin_dummy_block 10
		spans					5 6 7 8 9
	end_dummy_block

	;;; special general block
	begin_block 11
		min_units				1
		max_units				1
		unit_type				general_unit			1.0
		unit_density			close
		block_formation			line
		block_relative_pos		10 0 -3.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

end_formation




;****************************************************************
; Double Line. Cavalry in front
; infantry behind
;****************************************************************


begin_formation ai_double_cavalry_infantry

	;;; purpose flags
	attack
	;pursue

	ai_priority		0.6

	;;; The cavalry
	begin_block 0
		min_units				1
		unit_type				cavalry	1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;;; The infantry
	begin_block 1
		unit_type				infantry		1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -3.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;; put the artillery and handlers behind everyone
	begin_block 2
		unit_type					handler				1.0
		unit_type					siege				1.0
		block_formation				line
		block_relative_pos			1 0.0 -5.0
		inter_unit_spacing			3.0
		priority					1.0
	end_block

	;;; special general block
	begin_block 3
		min_units				1
		max_units				1
		unit_type				general_unit			1.0
		unit_density			close
		block_formation			line
		block_relative_pos		2 0 -3.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block


end_formation




;****************************************************************
; Triple Line. Missile troops in front, foot, in second row
; mounted in third row
;****************************************************************


begin_formation ai_triple_missiles_in_front

	;;; purpose flags
	defend
	ai_priority		0.6

	;;; the missile units
	begin_block 0
		min_units				1
		unit_type				missile infantry	1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;;; the second row
	begin_block 1
		min_units				1
		unit_type				heavy infantry	1.0
		unit_type				light infantry	1.0
		unit_type				skirmish infantry	1.0
		unit_type				spearmen infantry	1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block

	;;; the rear row
	begin_block 2
		min_units				1
		unit_type				cavalry	1.0
		unit_density			close
		block_formation			line
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block
	
	;; put the artillery and handlers behind everyone
	begin_dummy_block 3
		spans 0 1 2
	end_dummy_block

	begin_block 4
		unit_type					handler				1.0
		unit_type					siege				1.0
		block_formation				line
		block_relative_pos			3 0.0 -5.0
		inter_unit_spacing			3.0
		priority					1.0
	end_block
		
	;;; special general block
	begin_block 5
		min_units				1
		max_units				1
		unit_type				general_unit			1.0
		unit_density			close
		block_formation			line
		block_relative_pos		4 0 -5.0
		inter_unit_spacing		3.0
		priority				1.0
	end_block


end_formation

;***************************************************
;***************************************************
; Special formations - created by Sinuhet
;***************************************************
;***************************************************

;****************************************************************
; A single column with infantry units in front, followed by 
; missile troops followed by cavalry
;****************************************************************

begin_formation ai_single_column_infantry_in_front

	;;; purpose flags
	march
	ai_priority		0.60

	;;; infantry front block
	begin_block 0
		min_units				2
                max_units				3
                not_general
		unit_type				spearmen infantry	1.0
		unit_type				heavy infantry		0.9
		unit_type				light infantry		0.0
		unit_type				missile infantry	0.0
                default_melee_state	fire_at_will_and_defend
		unit_density			close
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		0.2
		priority				1.0
	end_block

	;;; infantry behind
	begin_block 1
                min_units				3
                not_general
		unit_type				infantry	1.0
		unit_density			close
		block_formation			column
		block_relative_pos		0 0.0 -5.0
		inter_unit_spacing		0.2
		priority				0.9
	end_block

	;;; cavalry behind
	begin_block 2
                min_units				2
                not_general
		unit_type				cavalry			1.0
		unit_density			close
		block_formation			column
		block_relative_pos		1 0.0 -10.0
		inter_unit_spacing		1.0
		priority				0.8
	end_block

        begin_dummy_block 3
		spans 0 1 2 
	end_dummy_block

	;; artillery and handlers behind everyone
	begin_block 4
                not_general
		unit_type				handler		1.0
		unit_type				siege		1.0
		unit_type				any		0.01
		block_formation				column
		block_relative_pos			3 0.0 -5.0
		inter_unit_spacing			10.0
		priority					0.5
	end_block

	begin_dummy_block 5
		spans 0 1 2 3 4
	end_dummy_block

	;; general at the back
	begin_block 6
		max_units				1
		unit_type				general_unit			1.0
		unit_density			close
		block_formation			column
		block_relative_pos		5 0.0 -30.0
		inter_unit_spacing		0.2
		priority				1.0
		end_block	

end_formation
		
;****************************************************************
; A single column with cavalry units in front, followed by 
; missile troops followed by infantry
;****************************************************************

begin_formation ai_single_column_cavalry_in_front

	;;; purpose flags
	march
	ai_priority		0.60

	;;; cavalry in front
	begin_block 0
                min_units				2
                not_general
		unit_type				cavalry			1.0
		unit_density			close
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		1.0
		priority				1.0
	end_block

	;;; missile units behind
	begin_block 1
                min_units				3
                not_general
		unit_type				missile infantry	1.0
		unit_density			close
		block_formation			column
		block_relative_pos		0 0.0 -15.0
		inter_unit_spacing		0.2
		priority				0.9
	end_block

	;;; infantry front block
	begin_block 2
		min_units				2
                max_units				3
                not_general
		unit_type				spearmen infantry	1.0
		unit_type				heavy infantry		0.9
		unit_type				light infantry		0.0
		unit_type				missile infantry	0.0
                default_melee_state	fire_at_will_and_defend
		unit_density			close
		block_formation			column
		block_relative_pos		1 0.0 -5.0
		inter_unit_spacing		0.2
		priority				0.9
	end_block

	;;; infantry further behind
	begin_block 3
		min_units				3
                not_general
		unit_type				spearmen infantry	1.0
		unit_type				heavy infantry		1.0
		unit_type				light infantry		1.0
		unit_density			close
		block_formation			column
		block_relative_pos		2 0.0 -5.0
		inter_unit_spacing		0.2
		priority				0.8
	end_block

        begin_dummy_block 4
		spans 0 1 2 3 
	end_dummy_block

	;; artillery and handlers behind everyone
	begin_block 5
                not_general
		unit_type				handler		1.0
		unit_type				siege		1.0
		unit_type				any		0.01
		block_formation				column
		block_relative_pos			4 0.0 -5.0
		inter_unit_spacing			10.0
		priority					0.5
	end_block

	begin_dummy_block 6
		spans 0 1 2 3 4 5
	end_dummy_block

	;; general at the back
	begin_block 7
		max_units				1
		unit_type				general_unit			1.0
		unit_density			close
		block_formation			column
		block_relative_pos		6 0.0 -30.0
		inter_unit_spacing		0.2
		priority				1.0
		end_block	

end_formation

;****************************************************************
; Basic Bridge assault column
;****************************************************************

begin_formation basic_ai_crossing_assault_force

	;;; purpose flags
	crossing_assault_force
	ai_priority					0.1	;; priority low, so we only choose if the flag is set

	;;; infantry front block
	begin_block 0
		min_units				1
                max_units				3
                not_general
		unit_type				heavy infantry		1.0
		unit_type				spearmen infantry	0.9
		unit_type				light infantry		0.0
		unit_type				missile infantry	0.0
		unit_formation			square
		unit_density			close
		max_unit_width			7
		block_formation			column
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		3.0
		priority				0.9
	end_block

	;;; behind
	begin_block 1
		max_units				3
                not_general
		unit_type				heavy infantry		1.0
		unit_type				spearmen infantry	0.9
		unit_type				light infantry		0.9
		unit_type				heavy cavalry		0.7
		unit_type				light cavalry		0.7
		unit_type				skirmish cavalry	0.7
		unit_type				missile cavalry		0.7
		unit_type				any			0.1
		unit_formation			square
		unit_density			close
		max_unit_width			7
		block_formation			column
		block_relative_pos		0 0.0 -3.0
		inter_unit_spacing		3.0
		priority				0.8

	end_block

	;;; further behind
	begin_block 2
		max_units				10
                not_general
		unit_type				heavy infantry		1.0
		unit_type				light infantry		0.9
		unit_type				heavy cavalry		0.7
		unit_type				light cavalry		0.7
		unit_type				skirmish cavalry	0.7
		unit_type				missile cavalry		0.7
		unit_type				any			0.1
		unit_formation			square
		unit_density			close
		max_unit_width			8
		block_formation			column
		block_relative_pos		1 0.0 -3.0
		inter_unit_spacing		3.0
		priority				0.6
	end_block

	;;; main body of units (everything else)
	begin_block 3
                not_general
		unit_type				any			1.0
		unit_density			close
		block_formation			line
		block_relative_pos		2 0.0 -3.0
		inter_unit_spacing		2.0
		priority				0.4
	end_block

	;;; if we have any swimming units put them on the flanks so they can swim over
	;;; and increase our attacking bandwidth
	begin_dummy_block 4
		spans 0 1 2 3
	end_dummy_block

	begin_block 5
		;;; at the moment all swimming units have to swim
		;;min_units				2
                not_general
		unit_type				swimming			1.0
		unit_density			close
		block_formation			line
		block_relative_pos		4 -10.0 0
		inter_unit_spacing		2.0
		priority				1.0
	end_block
	
	begin_block 6
		;;min_units				2
                not_general
		unit_type				swimming			1.0
		unit_density			close
		block_formation			line
		block_relative_pos		4 10.0 0
		inter_unit_spacing		2.0
		priority				1.0
	end_block

	;; general at the back
	begin_block 7
		max_units				1
		unit_type				general_unit			1.0
		unit_density			close
		block_formation			column
		block_relative_pos		3 0.0 -3.0
		inter_unit_spacing		0.2
		priority				1.0
		end_block

end_formation

;****************************************************************
; Bridge assault cover force
;****************************************************************

begin_formation ai_crossing_assault_cover

	crossing_assault_cover
	ai_priority					0.1	;; priority low, so we only choose if the flag is set

	begin_dummy_block 0					;; centre slot left empty for assault column to pass through
		spacer 0.0 0.0 35 20
	end_dummy_block

	begin_block 1	;; left front shooting position
		unit_type				missile infantry	1
		unit_type				missile cavalry		0.9
		unit_type				any					0.1
		unit_density			close
		block_formation			line
		block_relative_pos		0 -1.0 0.0
		inter_unit_spacing		2.0
		priority				1.0
	end_block

	begin_block 2	;; right front shooting position
		unit_type				missile infantry	1
		unit_type				missile cavalry		0.9
		unit_type				any					0.1
		unit_density			close
		block_formation			line
		block_relative_pos		0 1.0 0.0
		inter_unit_spacing		2.0
		priority				0.9
	end_block

	begin_block 3	;; left rear shooting position
		max_units				2
		unit_type				missile infantry	1
		unit_type				missile cavalry		0.9
		unit_density			close
		block_formation			line
		block_relative_pos		1 0.0 -3.0
		inter_unit_spacing		2.0
		priority				0.2
	end_block

	begin_block 4	;; right rear shooting position
		max_units				2
		unit_type				missile infantry	1
		unit_type				missile cavalry		0.9
		unit_density			close
		block_formation			line
		block_relative_pos		2 0.0 -3.0
		inter_unit_spacing		2.0
		priority				0.1
	end_block

	begin_block 5
		unit_type				siege			1	;; left artillery shooting position
		unit_density			close
		block_formation			line
		block_relative_pos		3 0.0 -60.0
		inter_unit_spacing		2.0
		priority				0.7
	end_block

	begin_block 6
		unit_type				siege			1	;; right artillery shooting position
		unit_density			close
		block_formation			line
		block_relative_pos		4 0.0 -60.0
		inter_unit_spacing		2.0
		priority				0.6
	end_block

end_formation

;****************************************************************
; Crossing Block
; For mixed missile and infantry forces
; defending close by a crossing
;****************************************************************

begin_formation ai_crossing_block
	
	crossing_block
	ai_priority					0.1								;; priority low, so we only choose if the flag is set

	;;; in front of bridge blocking crossing
	begin_block 0
		min_units				1
		max_units				1
		unit_type				heavy infantry			1
		unit_type				light infantry			0.5
		unit_type				skirmish infantry		0.5
		unit_type				any						0.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority				1.0
	end_block

	;;; left support of block 0
	begin_block 1
		max_units				1
		unit_type				heavy infantry			1
		unit_type				light infantry			0.8
		unit_type				skirmish infantry		0.8
		unit_type				heavy cavalry			0.1
		unit_type				light cavalry			0.1
		unit_type				skirmish cavalry		0.1
		unit_density			close
		block_formation			line
		block_relative_pos		0 -8.0 -1.0						;; to the left and slightly behind the back of block 0
		inter_unit_spacing		2.0
		priority				0.9
	end_block

	;;; right support of block 0
	begin_block 2
		max_units				1
		unit_type				heavy infantry			1
		unit_type				light infantry			0.8
		unit_type				skirmish infantry		0.8
		unit_type				heavy cavalry			0.1
		unit_type				light cavalry			0.1
		unit_type				skirmish cavalry		0.1
		unit_density			close
		block_formation			line
		block_relative_pos		0 8.0 -1.0						;; to the right and slightly behind the back of block 0
		inter_unit_spacing		2.0
		priority				0.9
	end_block

	;;; missile troops behind
	begin_block 3
		unit_type				missile infantry		1.0
		unit_type				missile cavalry			1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 -20.0
		inter_unit_spacing		2.0
		priority				0.9
	end_block

	;;; final line for other troops
	begin_block 4
		unit_type				heavy infantry			1.0
		unit_type				light infantry			1.0
		unit_type				skirmish infantry		1.0
		unit_type				heavy cavalry			1.0
		unit_type				light cavalry			1.0
		unit_type				skirmish cavalry		1.0
		unit_type				any						0.1
		unit_density			close
		block_formation			line
		block_relative_pos		3 0.0 -10.0
		inter_unit_spacing		2.0
		priority				0.1
	end_block

end_formation

;****************************************************************
; Crossing Defend
; For mixed missile and infantry forces
; conducting a standoff defence of a bridge
;****************************************************************

begin_formation ai_crossing_defend

	crossing_defend
	ai_priority					0.1								;; priority low, so we only choose if the flag is set

	;;; missile units in the centre
	begin_block 0
		min_units				1
		max_units				2
		unit_type				missile infantry				1.0
		unit_type				missile cavalry					0.8
		unit_type				heavy infantry					0.7
		unit_type				any								0.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority				1
	end_block

	;;; melee troops to left of flank shooters
	begin_block 1
		min_units				0
		max_units				2
		unit_type				heavy infantry					1.0
		unit_type				light infantry					0.7
		unit_type				skirmish infantry				0.7
		unit_type				heavy cavalry					0.7
		unit_type				light cavalry					0.7
		unit_type				skirmish cavalry				0.7
		unit_type				any								0.0
		block_formation			line
		block_relative_pos		0 -5.0 0.0
		inter_unit_spacing		2.0
		priority				0.9
	end_block

	;;; melee troops to left of flank shooters
	begin_block 2
		min_units				0
		max_units				2
		unit_type				heavy infantry					1.0
		unit_type				light infantry					0.7
		unit_type				skirmish infantry				0.7
		unit_type				heavy cavalry					0.7
		unit_type				light cavalry					0.7
		unit_type				skirmish cavalry				0.7
		unit_type				any								0.0
		block_formation			line
		block_relative_pos		0 5.0 0.0
		inter_unit_spacing		2.0
		priority				0.9
	end_block

	;;; everyone else in the second line
	begin_block 3
		unit_type				any								1.0
		block_formation			line
		block_relative_pos		0 0.0 -10.0
		inter_unit_spacing		2.0
		priority				0.5
	end_block

end_formation

;****************************************************************
; Basic Wall Assault
; Siege engine in the centre, covering troops on the flanks
; other units in a column behind, waiting to go up the siege tower
;****************************************************************

begin_formation basic_ai_wall_assault

	wall_assault_force
	ai_priority			0.10		;; priority low, so we only choose if the flag is set

	;;; gap for siege engines in the centre
	begin_dummy_block 0				;; centre slot left empty for assault column to pass through
		spacer 0.0 0.0 50 50
	end_dummy_block

	;;; all other units behind the siege engine


		; Screen of missile inf
		begin_block 1
			max_units			1
			unit_type			skirmish infantry		1.0
			unit_type			chanting_screeching		0.9
			unit_type			missile infantry		0.8
			unit_type			any				0.0
			unit_density		close
			block_formation		line
			block_relative_pos	0 0.0 -20.0
			inter_unit_spacing	2.0
			priority			0.3
		end_block

		;; First line of infantry
		begin_block 2
			max_units			1
			unit_type			light infantry			1.0
                        unit_type			heavy infantry			0.9
			unit_type			phalanx				0.2
			unit_type			any				0.0
			unit_density		close
			block_formation		line
			block_relative_pos	1 0.0 -7.0
			inter_unit_spacing	10.0
			priority			0.5
		end_block

		;; second line of infantry
		begin_block 3
			max_units			1
			unit_type			heavy infantry			1.0
			unit_type			light infantry			0.9
			unit_type			phalanx				0.5
			unit_type			any				0.0
			unit_density		close
			block_formation		line
			block_relative_pos	2 0.0 -10.0
			inter_unit_spacing	10.0
			priority			0.5
		end_block

		;; 3rd line of infantry, guard of archers
		begin_block 4
			max_units			2
			unit_type			phalanx				1.0
			unit_type			non_phalanx_spear		0.9
			unit_type			heavy infantry			0.6
			unit_type			light infantry			0.2
			unit_type			any				0.0
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	3 0.0 -10.0
			inter_unit_spacing	0.3
			priority			0.4
		end_block

		;; Archers behind
		begin_block 5
			max_units			2
			unit_type			ranged_missile_infantry		1.0			
			unit_type			missile infantry		0.5
			unit_type			chanting_screeching		0.3
			unit_type			skirmish infantry		0.4
			unit_type			any				0.0
			block_formation		line
			block_relative_pos	4 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.25
		end_block

		;; general at the back
		begin_block 6
			max_units			1
			unit_type			general_unit		1.0
			unit_type			any				0.0
			unit_density			close
			block_formation			line
			block_relative_pos		5 0.0 -5.0
			inter_unit_spacing		3.0
			priority				0.5
		end_block

		;; left flank cav
		begin_block 7
			not_general
			unit_type			cavalry 1.0
			unit_type			any				0.0
			block_formation		line
			block_relative_pos	6 -20.0 0.0
			inter_unit_spacing	4.0
			priority			0.25
		end_block

		;; right_flank cav
		begin_block 8
			not_general
			unit_type			cavalry 1.0
			unit_type			any				0.0
			block_formation		line
			block_relative_pos	6 20.0 0.0
			inter_unit_spacing	4.0
			priority			0.25
		end_block

		;; left flank missile cav
		begin_block 9
			not_general
			unit_type			missile cavalry 1.0
			unit_type			any				0.0
			block_formation		line
			block_relative_pos	7 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; right_flank missile cav
		begin_block 10
			not_general
			unit_type			missile cavalry 1.0
			unit_type			any				0.0
			block_formation		line
			block_relative_pos	8 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; artillery and handlers at the back
		begin_block 11
			unit_type			handler				1.0
			unit_type			any				0.0
			block_formation		line
			block_relative_pos	6 0.0 -20.0
			inter_unit_spacing	2.0
			priority			0.25
		end_block

		;; reserve of spearmen
		begin_block 12
			unit_type			phalanx				0.50
			unit_type			non_phalanx_spear		0.45
			unit_type			any				0.0
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	11 0.0 -10.0
			inter_unit_spacing	0.3
			priority			0.20
		end_block

		;; reserve of missile units
		begin_block 13
			unit_type			ranged_missile_infantry		0.50			
			unit_type			missile infantry		0.25
			unit_type			any				0.0
			block_formation		line
			block_relative_pos	12 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.10
		end_block

		;; reserve of heavy infantry
		begin_block 14
			unit_type			heavy infantry			0.50
			unit_type			any				0.0
			unit_density		close
			block_formation		line
			block_relative_pos	13 0.0 -10.0
			inter_unit_spacing	10.0
			priority			0.20
		end_block

		;; reserve of light infantry
		begin_block 15
			unit_type			light infantry			0.50
			unit_type			any				0.0
			unit_density		close
			block_formation		line
			block_relative_pos	14 0.0 -10.0
			inter_unit_spacing	10.0
			priority			0.20
		end_block

		;; any behind
		begin_block 16
			unit_type			any				0.10
			block_formation				line
			block_relative_pos			15 0.0 -10.0
			inter_unit_spacing			0.3
			priority					0.05
		end_block

end_formation

;****************************************************************
; Basic Siege deployment
; The engines have already been assigned at this point
; Put rams in the centre front, other engines at the front either side
;****************************************************************

begin_formation Basic_deployment_siege

	standard_siege_attacker_deployment
	ai_priority				0.15

	;;; rams at the centre
	begin_block 0
		unit_type				carrying_siege_engine ram	1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		20.0
		priority				1.0
	end_block

	;; other engines left side
	begin_block 1
		unit_type				carrying_siege_engine ladder	1.0
		unit_type				carrying_siege_engine tower	1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 -10.0 0.0
		inter_unit_spacing		20.0
		priority				1.0
	end_block

	;; other engines right side
	begin_block 2
		unit_type				carrying_siege_engine ladder	1.0
		unit_type				carrying_siege_engine tower	1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 10.0 0.0
		inter_unit_spacing		20.0
		priority				1.0
	end_block

        begin_dummy_block 3
		spans 0 1 2 
	end_dummy_block

		; Screen of missile inf
		begin_block 4
			max_units			5
			unit_type			skirmish infantry		1.0
			unit_type			chanting_screeching		0.9
			unit_type			missile infantry		0.8
			unit_type			carrying_siege_engine ram	0.0
			unit_type			carrying_siege_engine ladder	0.0
			unit_type			carrying_siege_engine tower	0.0
			unit_density		close
			block_formation		line
			block_relative_pos	3 0.0 -20.0
			inter_unit_spacing	2.0
			priority			0.3
		end_block

		;; First line of infantry
		begin_block 5
			min_units			1
			max_units			8
			unit_type			light infantry			1.0
                        unit_type			heavy infantry			0.9
			unit_type			phalanx				0.2
			unit_type			carrying_siege_engine ram	0.0
			unit_type			carrying_siege_engine ladder	0.0
			unit_type			carrying_siege_engine tower	0.0
			unit_density		close
			block_formation		line
			block_relative_pos	4 0.0 -7.0
			inter_unit_spacing	10.0
			priority			0.5
		end_block

		;; second line of infantry
		begin_block 6
			min_units			1
			max_units			8
			unit_type			heavy infantry			1.0
			unit_type			light infantry			0.9
			unit_type			phalanx				0.5
			unit_type			carrying_siege_engine ram	0.0
			unit_type			carrying_siege_engine ladder	0.0
			unit_type			carrying_siege_engine tower	0.0
			unit_density		close
			block_formation		line
			block_relative_pos	5 0.0 -10.0
			inter_unit_spacing	10.0
			priority			0.5
		end_block

	begin_dummy_block 7
		spans 0 1 2 3 4 5 6
	end_dummy_block

		;; 3rd line of infantry, guard of archers
		begin_block 8
			min_units			1
			unit_type			phalanx				1.0
			unit_type			non_phalanx_spear		0.9
			unit_type			heavy infantry			0.6
			unit_type			light infantry			0.2
			unit_type			carrying_siege_engine ram	0.0
			unit_type			carrying_siege_engine ladder	0.0
			unit_type			carrying_siege_engine tower	0.0
			unit_formation		square
			unit_density		close
			block_formation		line
			block_relative_pos	7 0.0 -10.0
			inter_unit_spacing	0.3
			priority			0.4
		end_block

		;; Archers behind
		begin_block 9
			max_units			10
			unit_type			ranged_missile_infantry		1.0			
			unit_type			missile infantry		0.5
			unit_type			chanting_screeching		0.3
			unit_type			skirmish infantry		0.4
			unit_type			carrying_siege_engine ram	0.0
			unit_type			carrying_siege_engine ladder	0.0
			unit_type			carrying_siege_engine tower	0.0
			block_formation		line
			block_relative_pos	8 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.25
		end_block

	begin_dummy_block 10
		spans 0 1 2 3 4 5 6 7 8 9 
	end_dummy_block

		;; general at the back
		begin_block 11
			min_units			1
			max_units			1
			unit_type			general_unit		1.0
			unit_type			carrying_siege_engine ram	0.0
			unit_type			carrying_siege_engine ladder	0.0
			unit_type			carrying_siege_engine tower	0.0
			unit_density			close
			block_formation			line
			block_relative_pos		10 0.0 -5.0
			inter_unit_spacing		3.0
			priority				0.5
		end_block

		;; cavalry on the flanks and back a bit

		;; left flank cav
		begin_block 12
			not_general
			unit_type			cavalry 1.0
			unit_type			carrying_siege_engine ram	0.0
			unit_type			carrying_siege_engine ladder	0.0
			unit_type			carrying_siege_engine tower	0.0
			block_formation		line
			block_relative_pos	11 -20.0 0.0
			inter_unit_spacing	4.0
			priority			0.25
		end_block

		;; right_flank cav
		begin_block 13
			not_general
			unit_type			cavalry 1.0
			unit_type			carrying_siege_engine ram	0.0
			unit_type			carrying_siege_engine ladder	0.0
			unit_type			carrying_siege_engine tower	0.0
			block_formation		line
			block_relative_pos	11 20.0 0.0
			inter_unit_spacing	4.0
			priority			0.25
		end_block

		;; left flank missile cav
		begin_block 14
			not_general
			unit_type			missile cavalry 1.0
			unit_type			carrying_siege_engine ram	0.0
			unit_type			carrying_siege_engine ladder	0.0
			unit_type			carrying_siege_engine tower	0.0
			block_formation		line
			block_relative_pos	12 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; right_flank missile cav
		begin_block 15
			not_general
			unit_type			missile cavalry 1.0
			unit_type			carrying_siege_engine ram	0.0
			unit_type			carrying_siege_engine ladder	0.0
			unit_type			carrying_siege_engine tower	0.0
			block_formation		line
			block_relative_pos	13 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; artillery and handlers at the back
		begin_block 16
			unit_type			handler				1.0
			unit_type			carrying_siege_engine ram	0.0
			unit_type			carrying_siege_engine ladder	0.0
			unit_type			carrying_siege_engine tower	0.0
			block_formation		line
			block_relative_pos	11 0.0 -20.0
			inter_unit_spacing	2.0
			priority			0.25
		end_block

		;; any behind
		begin_block 17
			unit_type			any				0.5
			unit_type			carrying_siege_engine ram	0.0
			unit_type			carrying_siege_engine ladder	0.0
			unit_type			carrying_siege_engine tower	0.0
			block_formation				line
			block_relative_pos			16 0.0 -20.0
			inter_unit_spacing			0.3
			priority					0.05
		end_block

end_formation

;****************************************************************
; Roman Siege deployment formation - Defensive Square
;****************************************************************

begin_formation Roman_deployment_siege

	;;; purpose flags
	standard_siege_attacker_deployment
	ai_priority		0.20

        supported_factions	romans_julii, romans_brutii, romans_scipii, romans_senate

	;;; rams at the centre
	begin_block 0
		unit_type				carrying_siege_engine ram	1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		20.0
		priority				1.0
	end_block

	;; other engines left side
	begin_block 1
		unit_type				carrying_siege_engine ladder	1.0
		unit_type				carrying_siege_engine tower	1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 -10.0 0.0
		inter_unit_spacing		20.0
		priority				1.0
	end_block

	;; other engines right side
	begin_block 2
		unit_type				carrying_siege_engine ladder	1.0
		unit_type				carrying_siege_engine tower	1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 10.0 0.0
		inter_unit_spacing		20.0
		priority				1.0
	end_block

        begin_dummy_block 3
		spans 0 1 2 
	end_dummy_block

		;; other units behind

		;; hastati line
		begin_block 4
			max_units		3
			unit_type		light_pilum_infantry 1.0
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	3 0.0 -20.0
			inter_unit_spacing	0.3
			priority			0.5
		end_block

		;; princeps left side
		begin_block 5
			min_units		1
			max_units		3
			unit_type		heavy_pilum_infantry 1.0
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	4 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.5
		end_block

		;; princeps right side
		begin_block 6
			min_units		1
			max_units		3
			unit_type		heavy_pilum_infantry 1.0
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	4 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.5
		end_block

		begin_dummy_block 7
			spans 4 5 6
		end_dummy_block

		;; missile troops behind the infantry

		begin_block 8
			min_units		1
			max_units		2
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	4 0.0 -5.0
			inter_unit_spacing	2.0
			priority			0.4
		end_block

		begin_block 9
			max_units		2
			unit_type			skirmish infantry	1.0
			unit_type			missile infantry	0.8
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	8 0.0 -1.0
			inter_unit_spacing	2.0
			priority			0.35
		end_block

		;; general
		begin_block 10
			min_units		1
			max_units		1
			unit_type				general_unit	1.0
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			default_melee_state	defend
			unit_density			close
			block_formation			line
			block_relative_pos		9 0.0 -5.0
			inter_unit_spacing		3.0
			priority				0.5
		end_block

		;; artillery and handler on the sides

		begin_block 11
			max_units				1
			unit_type			handler			1.0
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			block_formation				line
			block_relative_pos			10 -10.0 0.0
			inter_unit_spacing			3.0
			priority					0.05
		end_block

		begin_block 12
			max_units				1
			unit_type			handler			1.0
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			block_formation				line
			block_relative_pos			10 10.0 0.0
			inter_unit_spacing			3.0
			priority					0.05
		end_block

		begin_dummy_block 13
			spans 10 11 12
		end_dummy_block

		;; archers behind the general

		begin_block 14
			min_units		1
			max_units		2
			unit_type			ranged_missile_infantry 1.0
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	10 0.0 -10.0
			inter_unit_spacing	2.0
			priority			0.4
		end_block

		begin_block 15
			max_units		2
			unit_type			ranged_missile_infantry 1.0
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0			
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	14 0.0 -1.0
			inter_unit_spacing	2.0
			priority			0.35
		end_block

		;; cavalry on the flanks

		;; left flank
		begin_block 16
			not_general
			unit_type			cavalry 1.0
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			block_formation		line
			block_relative_pos	10 -80.0 0.0
			inter_unit_spacing	4.0
			priority			0.25
		end_block

		;; right_flank
		begin_block 17
			not_general
			unit_type			cavalry 1.0
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			block_formation		line
			block_relative_pos	10 80.0 0.0
			inter_unit_spacing	4.0
			priority			0.25
		end_block

		;; left flank missile cav
		begin_block 18
			not_general
			unit_type			missile cavalry 1.0
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			block_formation		line
			block_relative_pos	16 -5.0 0.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		;; right_flank missile cav
		begin_block 19
			not_general
			unit_type			missile cavalry 1.0
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			block_formation		line
			block_relative_pos	17 5.0 0.0
			inter_unit_spacing	4.0
			priority			0.3
		end_block

		begin_dummy_block 20
			spans 10 11 12 13 14 15 16 17 18 19
		end_dummy_block

		;; back line of infantry

		;; hastati or auxilia line
		begin_block 21
			max_units		5
			unit_type		light infantry 1.0
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	14 0.0 -5.0
			inter_unit_spacing	0.3
			priority			0.45
		end_block

		;; triarii left side
		begin_block 22
			min_units		1
			max_units		2
			unit_type		non_phalanx_spear 1.0
			unit_type		heavy_pilum_infantry 0.1
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	21 -0.3 0.0
			inter_unit_spacing	0.3
			priority			0.5
		end_block

		;; triarii right side
		begin_block 23
			min_units		1
			max_units		2
			unit_type		non_phalanx_spear 1.0
			unit_type		heavy_pilum_infantry 0.1
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			default_melee_state	fire_at_will_and_defend
			block_formation		line
			block_relative_pos	21 0.3 0.0
			inter_unit_spacing	0.3
			priority			0.5
		end_block

		begin_dummy_block 24
			spans 21 22 23
		end_dummy_block

		;; back line of other units
		begin_block 25
			unit_type			any			0.01
			unit_type		carrying_siege_engine ram	0.0
			unit_type		carrying_siege_engine ladder	0.0
			unit_type		carrying_siege_engine tower	0.0
			default_melee_state	fire_at_will_and_defend
			block_formation				line
			block_relative_pos			24 0.0 -10.0
			inter_unit_spacing			0.3
			priority					0.01
		end_block

end_formation

;****************************************************************
; Siege deployment
; The engines have already been assigned at this point
; Put rams in the centre front, other engines at the front either side
;****************************************************************

begin_formation deployment_siege

	standard_siege_attacker_deployment
	ai_priority				0.10

	;;; rams at the centre
	begin_block 0
		unit_type				carrying_siege_engine ram		1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		8.0
		priority				1.0
	end_block

	;; other engines left side
	begin_block 1
		unit_type				carrying_siege_engine ladder	1.0
		unit_type				carrying_siege_engine tower		1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 -8.0 0.0
		inter_unit_spacing		8.0
		priority				1.0
	end_block

	;; other infantry left side
	begin_block 2
		unit_type				heavy infantry					0.7
		unit_type				light infantry					0.7
		unit_type				skirmish infantry				0.7
		unit_density			close
		block_formation			line
		block_relative_pos		1 -8.0 0.0
		inter_unit_spacing		8.0
		priority				0.5
	end_block

	;; other engines right side
	begin_block 3
		unit_type				carrying_siege_engine ladder	1.0
		unit_type				carrying_siege_engine tower		1.0
		unit_density			close
		block_formation			line
		block_relative_pos		0 8.0 0.0
		inter_unit_spacing		8.0
		priority				1.0
	end_block

	;; other infantry rightt side
	begin_block 4
		unit_type				heavy infantry					0.7
		unit_type				light infantry					0.7
		unit_type				skirmish infantry				0.7
		unit_density			close
		block_formation			line
		block_relative_pos		3 8.0 0.0
		inter_unit_spacing		8.0
		priority				0.5
	end_block

	begin_dummy_block 5
		spans 0 1 2 3 4
	end_dummy_block

	;;; archers behind to give support
	begin_block 6
		unit_type				missile infantry				1.0
		unit_density			close
		block_formation			line
		block_relative_pos		5 0.0 -10.0
		inter_unit_spacing		2.0
		priority				0.1
	end_block

	;;; cavalry at the back
	begin_block 7
		unit_type				heavy cavalry					1.0
		unit_type				light cavalry					1.0
		unit_type				skirmish cavalry				1.0
		unit_type				any								0.1
		unit_density			close
		block_formation			line
		block_relative_pos		6 0.0 -10.0
		inter_unit_spacing		2.0
		priority				0.1
	end_block

end_formation

;****************************************************************
; Ambush deployment
; Column marching formation for the army being ambushed
;****************************************************************
	
begin_formation ambush_defender_deployment

	standard_ambush_defender_deployment
	ai_priority 0.1

	;;; general at the front
	begin_block 0
		min_units				1
		max_units				1
		unit_type				general_unit			1.0
		unit_density			close
		max_unit_width			4
		block_formation			line
		block_relative_pos		0 0.0 0.0
		inter_unit_spacing		2.0
		priority				1.0
	end_block

	;;; all other units behind
	begin_block 1
		unit_type				any					1.0
		unit_density			close
		max_unit_width			4
		block_formation			column
		block_relative_pos		0 0.0 -2.0
		inter_unit_spacing		2.0
		priority				1.0
	end_block

        ;;; all other units behind(2)
	begin_block 2
		unit_type				any					1.0
		unit_density			close
		max_unit_width			4
		block_formation			column
		block_relative_pos		0 2.0 0.0
		inter_unit_spacing		2.0
		priority				1.0
	end_block

end_formation
